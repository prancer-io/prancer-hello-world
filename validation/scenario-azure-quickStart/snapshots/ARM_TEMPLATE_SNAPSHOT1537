{
  "structure": "filesystem",
  "error": null,
  "reference": "master",
  "contentType": "json",
  "source": "gitConnectorAzureQuickStart",
  "paths": [
    "/quickstarts/microsoft.network/front-door-premium-vm-private-link/azuredeploy.json",
    "/quickstarts/microsoft.network/front-door-premium-vm-private-link/azuredeploy.parameters.json"
  ],
  "timestamp": 1642962908909,
  "queryuser": null,
  "checksum": "99914b932bd37a50b983c5e7c90ae93b",
  "node": {
    "masterSnapshotId": "ARM_TEMPLATE_SNAPSHOT",
    "type": "arm",
    "collection": "armtemplate",
    "paths": [
      "/quickstarts/microsoft.network/front-door-premium-vm-private-link/azuredeploy.json",
      "/quickstarts/microsoft.network/front-door-premium-vm-private-link/azuredeploy.parameters.json"
    ],
    "snapshotId": "ARM_TEMPLATE_SNAPSHOT1537",
    "status": "active",
    "validate": true,
    "resourceTypes": [
      "microsoft.resources/deployments"
    ]
  },
  "snapshotId": "ARM_TEMPLATE_SNAPSHOT1537",
  "collection": "armtemplate",
  "json": {
    "contentVersion": "1.0.0.0",
    "parameters": {
      "location": {
        "type": "string",
        "allowedValues": [
          "eastus",
          "westus2",
          "southcentralus"
        ],
        "metadata": {
          "description": "The location into which the Azure Storage resources should be deployed. When using Private Link origins with Front Door Premium during the preview period, there is a limited set of regions available for use. See https://docs.microsoft.com/en-us/azure/frontdoor/standard-premium/concept-private-link#limitations for more details."
        },
        "value": "eastus"
      },
      "vnetIPPrefix": {
        "type": "string",
        "defaultValue": "10.0.0.0/16",
        "metadata": {
          "description": "The IP address prefix (CIDR range) to use when deploying the virtual network."
        }
      },
      "vmSubnetIPPrefix": {
        "type": "string",
        "defaultValue": "10.0.0.0/24",
        "metadata": {
          "description": "The IP address prefix (CIDR range) to use when deploying the VM subnet within the virtual network."
        }
      },
      "privateLinkServiceSubnetIPPrefix": {
        "type": "string",
        "defaultValue": "10.0.1.0/24",
        "metadata": {
          "description": "The IP address prefix (CIDR range) to use when deploying the Private Link service subnet within the virtual network."
        }
      },
      "vmSize": {
        "type": "string",
        "defaultValue": "Standard_D2s_v3",
        "metadata": {
          "description": "The name of the SKU to use when creating the virtual machine."
        }
      },
      "vmOSName": {
        "type": "string",
        "defaultValue": "Windows2019Datacenter",
        "allowedValues": [
          "Windows2016Datacenter",
          "Windows2019Datacenter"
        ],
        "metadata": {
          "description": "The name of the operating system to deploy on the virtual machine."
        }
      },
      "vmOSDiskStorageAccountType": {
        "type": "string",
        "defaultValue": "StandardSSD_LRS",
        "metadata": {
          "description": "The type of disk and storage account to use for the virtual machine's OS disk."
        }
      },
      "vmAdminUsername": {
        "type": "string",
        "metadata": {
          "description": "The administrator username to use for the virtual machine."
        },
        "value": "GEN-UNIQUE"
      },
      "vmAdminPassword": {
        "type": "secureString",
        "metadata": {
          "description": "The administrator password to use for the virtual machine."
        },
        "value": "GEN-PASSWORD"
      },
      "frontDoorEndpointName": {
        "type": "string",
        "defaultValue": "[format('afd-{0}', uniqueString(resourceGroup().id))]",
        "metadata": {
          "description": "The name of the Front Door endpoint to create. This must be globally unique."
        }
      }
    },
    "functions": [],
    "variables": {
      "vmImageReference": {
        "Windows2019Datacenter": {
          "publisher": "MicrosoftWindowsServer",
          "offer": "WindowsServer",
          "sku": "2019-Datacenter",
          "version": "latest"
        },
        "Windows2016Datacenter": {
          "publisher": "MicrosoftWindowsServer",
          "offer": "WindowsServer",
          "sku": "2016-Datacenter",
          "version": "latest"
        }
      },
      "frontDoorSkuName": "Premium_AzureFrontDoor"
    },
    "resources": [
      {
        "type": "Microsoft.Resources/deployments",
        "apiVersion": "2019-10-01",
        "name": "network",
        "properties": {
          "expressionEvaluationOptions": {
            "scope": "inner"
          },
          "mode": "Incremental",
          "parameters": {
            "location": {
              "value": "eastus"
            },
            "vnetIPPrefix": {
              "value": "10.0.0.0/16"
            },
            "vmSubnetIPPrefix": {
              "value": "10.0.0.0/24"
            },
            "privateLinkServiceSubnetIPPrefix": {
              "value": "10.0.1.0/24"
            }
          },
          "template": {
            "contentVersion": "1.0.0.0",
            "parameters": {
              "location": {
                "type": "string",
                "metadata": {
                  "description": "The location into which the virtual network resources should be deployed."
                }
              },
              "vnetIPPrefix": {
                "type": "string",
                "metadata": {
                  "description": "The IP address prefix (CIDR range) to use when deploying the virtual network."
                }
              },
              "vmSubnetIPPrefix": {
                "type": "string",
                "metadata": {
                  "description": "The IP address prefix (CIDR range) to use when deploying the VM subnet within the virtual network."
                }
              },
              "privateLinkServiceSubnetIPPrefix": {
                "type": "string",
                "metadata": {
                  "description": "The IP address prefix (CIDR range) to use when deploying the Private Link service environment subnet within the virtual network."
                }
              }
            },
            "functions": [],
            "variables": {
              "vnetName": "VNet",
              "vmSubnetName": "VMs",
              "privateLinkServiceSubnetName": "PrivateLinkService"
            },
            "resources": [
              {
                "type": "Microsoft.Network/virtualNetworks",
                "apiVersion": "2020-06-01",
                "name": "vnetName",
                "location": "eastus",
                "properties": {
                  "addressSpace": {
                    "addressPrefixes": [
                      "10.0.0.0/16"
                    ]
                  },
                  "subnets": [
                    {
                      "name": "vmSubnetName",
                      "properties": {
                        "addressPrefix": "10.0.0.0/24"
                      }
                    },
                    {
                      "name": "privateLinkServiceSubnetName",
                      "properties": {
                        "addressPrefix": "10.0.1.0/24",
                        "privateLinkServiceNetworkPolicies": "Disabled"
                      }
                    }
                  ]
                }
              }
            ],
            "outputs": {
              "vnetName": {
                "type": "string",
                "value": "vnetName"
              },
              "vmSubnetResourceId": {
                "type": "string",
                "value": "Microsoft.Network/virtualNetworks/subnets/vnetName/vmSubnetName"
              },
              "privateLinkServiceSubnetResourceId": {
                "type": "string",
                "value": "Microsoft.Network/virtualNetworks/subnets/vnetName/privateLinkServiceSubnetName"
              }
            },
            "\uff04schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#"
          }
        }
      },
      {
        "type": "Microsoft.Resources/deployments",
        "apiVersion": "2019-10-01",
        "name": "load-balancer",
        "properties": {
          "expressionEvaluationOptions": {
            "scope": "inner"
          },
          "mode": "Incremental",
          "parameters": {
            "location": {
              "value": "eastus"
            },
            "subnetResourceId": {
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'network'), '2019-10-01').outputs.vmSubnetResourceId.value]"
            }
          },
          "template": {
            "contentVersion": "1.0.0.0",
            "parameters": {
              "location": {
                "type": "string",
                "metadata": {
                  "description": "The location into which the load balancer resources should be deployed."
                }
              },
              "subnetResourceId": {
                "type": "string",
                "metadata": {
                  "description": "The resource ID of the virtual network subnet that the load balancer should be deployed into."
                }
              }
            },
            "functions": [],
            "variables": {
              "loadBalancerName": "MyLoadBalancer",
              "frontendIPConfigurationName": "MyFrontendIPConfiguration",
              "healthProbeName": "MyHealthProbe",
              "backendAddressPoolName": "MyBackendAddressPool"
            },
            "resources": [
              {
                "type": "Microsoft.Network/loadBalancers",
                "apiVersion": "2020-06-01",
                "name": "loadBalancerName",
                "location": "eastus",
                "sku": {
                  "name": "Standard"
                },
                "properties": {
                  "frontendIPConfigurations": [
                    {
                      "name": "frontendIPConfigurationName",
                      "properties": {
                        "privateIPAllocationMethod": "Dynamic",
                        "subnet": {
                          "id": "subnetResourceId"
                        }
                      }
                    }
                  ],
                  "backendAddressPools": [
                    {
                      "name": "backendAddressPoolName"
                    }
                  ],
                  "probes": [
                    {
                      "name": "healthProbeName",
                      "properties": {
                        "protocol": "Tcp",
                        "port": 80,
                        "intervalInSeconds": 15,
                        "numberOfProbes": 2
                      }
                    }
                  ],
                  "loadBalancingRules": [
                    {
                      "name": "HttpRule",
                      "properties": {
                        "protocol": "Tcp",
                        "frontendPort": 80,
                        "backendPort": 80,
                        "idleTimeoutInMinutes": 15,
                        "frontendIPConfiguration": {
                          "id": "Microsoft.Network/loadBalancers/frontendIpConfigurations/loadBalancerName/frontendIPConfigurationName"
                        },
                        "backendAddressPool": {
                          "id": "Microsoft.Network/loadBalancers/backendAddressPools/loadBalancerName/backendAddressPoolName"
                        },
                        "probe": {
                          "id": "Microsoft.Network/loadBalancers/probes/loadBalancerName/healthProbeName"
                        }
                      }
                    }
                  ]
                }
              }
            ],
            "outputs": {
              "frontendIPAddress": {
                "type": "string",
                "value": "[reference(resourceId('Microsoft.Network/loadBalancers', variables('loadBalancerName'))).frontendIPConfigurations[0].properties.privateIPAddress]"
              },
              "frontendIPConfigurationResourceId": {
                "type": "string",
                "value": "Microsoft.Network/loadBalancers/frontendIpConfigurations/loadBalancerName/frontendIPConfigurationName"
              },
              "backendAddressPoolResourceId": {
                "type": "string",
                "value": "Microsoft.Network/loadBalancers/backendAddressPools/loadBalancerName/backendAddressPoolName"
              }
            },
            "\uff04schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#"
          }
        },
        "dependsOn": [
          "Microsoft.Resources/deployments/network"
        ]
      },
      {
        "type": "Microsoft.Resources/deployments",
        "apiVersion": "2019-10-01",
        "name": "vm",
        "properties": {
          "expressionEvaluationOptions": {
            "scope": "inner"
          },
          "mode": "Incremental",
          "parameters": {
            "location": {
              "value": "eastus"
            },
            "subnetResourceId": {
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'network'), '2019-10-01').outputs.vmSubnetResourceId.value]"
            },
            "vmImageReference": {
              "value": "(vmImageReference)[parameters(vmOSName)]"
            },
            "vmSize": {
              "value": "Standard_D2s_v3"
            },
            "vmOSDiskStorageAccountType": {
              "value": "StandardSSD_LRS"
            },
            "vmAdminUsername": {
              "value": "GEN-UNIQUE"
            },
            "vmAdminPassword": {
              "value": "GEN-PASSWORD"
            },
            "loadBalancerBackendAddressPoolResourceId": {
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'load-balancer'), '2019-10-01').outputs.backendAddressPoolResourceId.value]"
            }
          },
          "template": {
            "contentVersion": "1.0.0.0",
            "parameters": {
              "location": {
                "type": "string",
                "metadata": {
                  "description": "The location into which the Private Link service resources should be deployed."
                }
              },
              "subnetResourceId": {
                "type": "string",
                "metadata": {
                  "description": "The resource ID of the virtual network subnet that the VM should be deployed into."
                }
              },
              "vmSize": {
                "type": "string",
                "metadata": {
                  "description": "The name of the SKU to use when creating the virtual machine."
                }
              },
              "vmImageReference": {
                "type": "object",
                "metadata": {
                  "description": "The details of the image to deploy on the virtual machine."
                }
              },
              "vmOSDiskStorageAccountType": {
                "type": "string",
                "defaultValue": "StandardSSD_LRS",
                "allowedValues": [
                  "Standard_LRS",
                  "StandardSSD_LRS",
                  "Premium_LRS"
                ],
                "metadata": {
                  "description": "The type of disk and storage account to use for the virtual machine's OS disk."
                }
              },
              "vmAdminUsername": {
                "type": "string",
                "metadata": {
                  "description": "The administrator username to use for the virtual machine."
                }
              },
              "vmAdminPassword": {
                "type": "secureString",
                "metadata": {
                  "description": "The administrator password to use for the virtual machine."
                }
              },
              "loadBalancerBackendAddressPoolResourceId": {
                "type": "string",
                "metadata": {
                  "description": "The resource ID of the load balancer's backend address pool, which this virtual machine's NIC will be added to."
                }
              }
            },
            "functions": [],
            "variables": {
              "vmName": "MyVM",
              "vmNicName": "MyVM-NIC",
              "vmOSDiskName": "MyVM-OSDisk"
            },
            "resources": [
              {
                "type": "Microsoft.Compute/virtualMachines/extensions",
                "apiVersion": "2020-06-01",
                "name": "[format('{0}/{1}', variables('vmName'), 'InstallCustomScript')]",
                "location": "eastus",
                "properties": {
                  "publisher": "Microsoft.Compute",
                  "type": "CustomScriptExtension",
                  "typeHandlerVersion": "1.0",
                  "autoUpgradeMinorVersion": true,
                  "protectedSettings": {
                    "commandToExecute": "powershell -ExecutionPolicy Unrestricted Install-WindowsFeature -Name Web-Server"
                  }
                },
                "dependsOn": [
                  "Microsoft.Compute/virtualMachines/vmName"
                ]
              },
              {
                "type": "Microsoft.Network/networkInterfaces",
                "apiVersion": "2020-06-01",
                "name": "vmNicName",
                "location": "eastus",
                "properties": {
                  "ipConfigurations": [
                    {
                      "name": "ipConfig",
                      "properties": {
                        "privateIPAllocationMethod": "Dynamic",
                        "subnet": {
                          "id": "subnetResourceId"
                        },
                        "loadBalancerBackendAddressPools": [
                          {
                            "id": "loadBalancerBackendAddressPoolResourceId"
                          }
                        ]
                      }
                    }
                  ]
                }
              },
              {
                "type": "Microsoft.Compute/virtualMachines",
                "apiVersion": "2020-06-01",
                "name": "vmName",
                "location": "eastus",
                "properties": {
                  "hardwareProfile": {
                    "vmSize": "Standard_D2s_v3"
                  },
                  "osProfile": {
                    "computerName": "vmName",
                    "adminUsername": "GEN-UNIQUE",
                    "adminPassword": "GEN-PASSWORD"
                  },
                  "storageProfile": {
                    "imageReference": "vmImageReference",
                    "osDisk": {
                      "name": "vmOSDiskName",
                      "caching": "ReadWrite",
                      "createOption": "FromImage",
                      "managedDisk": {
                        "storageAccountType": "StandardSSD_LRS"
                      },
                      "diskSizeGB": 128
                    }
                  },
                  "networkProfile": {
                    "networkInterfaces": [
                      {
                        "id": "Microsoft.Network/networkInterfaces/vmNicName"
                      }
                    ]
                  }
                },
                "dependsOn": [
                  "Microsoft.Network/networkInterfaces/vmNicName"
                ]
              }
            ],
            "\uff04schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#"
          }
        },
        "dependsOn": [
          "Microsoft.Resources/deployments/load-balancer",
          "Microsoft.Resources/deployments/network"
        ]
      },
      {
        "type": "Microsoft.Resources/deployments",
        "apiVersion": "2019-10-01",
        "name": "private-link-service",
        "properties": {
          "expressionEvaluationOptions": {
            "scope": "inner"
          },
          "mode": "Incremental",
          "parameters": {
            "location": {
              "value": "eastus"
            },
            "subnetResourceId": {
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'network'), '2019-10-01').outputs.privateLinkServiceSubnetResourceId.value]"
            },
            "loadBalancerFrontendIpConfigurationResourceId": {
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'load-balancer'), '2019-10-01').outputs.frontendIPConfigurationResourceId.value]"
            }
          },
          "template": {
            "contentVersion": "1.0.0.0",
            "parameters": {
              "location": {
                "type": "string",
                "metadata": {
                  "description": "The location into which the Private Link service resources should be deployed."
                }
              },
              "subnetResourceId": {
                "type": "string",
                "metadata": {
                  "description": "The resource ID of the virtual network subnet that the Private Link service should be deployed into."
                }
              },
              "loadBalancerFrontendIpConfigurationResourceId": {
                "type": "string",
                "metadata": {
                  "description": "The resource ID of the load balancer's frontend IP configuration that should be associated with this Private Link service."
                }
              }
            },
            "functions": [],
            "variables": {
              "privateLinkServiceName": "MyPrivateLinkService"
            },
            "resources": [
              {
                "type": "Microsoft.Network/privateLinkServices",
                "apiVersion": "2020-06-01",
                "name": "privateLinkServiceName",
                "location": "eastus",
                "properties": {
                  "enableProxyProtocol": false,
                  "loadBalancerFrontendIpConfigurations": [
                    {
                      "id": "loadBalancerFrontendIpConfigurationResourceId"
                    }
                  ],
                  "ipConfigurations": [
                    {
                      "name": "application-configuration",
                      "properties": {
                        "privateIPAllocationMethod": "Dynamic",
                        "privateIPAddressVersion": "IPv4",
                        "subnet": {
                          "id": "subnetResourceId"
                        },
                        "primary": false
                      }
                    }
                  ]
                }
              }
            ],
            "outputs": {
              "privateLinkServiceResourceId": {
                "type": "string",
                "value": "Microsoft.Network/privateLinkServices/privateLinkServiceName"
              },
              "privateLinkServiceLocation": {
                "type": "string",
                "value": "[reference(resourceId('Microsoft.Network/privateLinkServices', variables('privateLinkServiceName')), '2020-06-01', 'full').location]"
              }
            },
            "\uff04schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#"
          }
        },
        "dependsOn": [
          "Microsoft.Resources/deployments/load-balancer",
          "Microsoft.Resources/deployments/network"
        ]
      },
      {
        "type": "Microsoft.Resources/deployments",
        "apiVersion": "2019-10-01",
        "name": "front-door",
        "properties": {
          "expressionEvaluationOptions": {
            "scope": "inner"
          },
          "mode": "Incremental",
          "parameters": {
            "skuName": {
              "value": "Premium_AzureFrontDoor"
            },
            "endpointName": {
              "value": "[format('afd-{0}', uniqueString(resourceGroup().id))]"
            },
            "originHostName": {
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'load-balancer'), '2019-10-01').outputs.frontendIPAddress.value]"
            },
            "originForwardingProtocol": {
              "value": "HttpOnly"
            },
            "privateEndpointResourceId": {
              "value": "[reference(resourceId('Microsoft.Resources/deployments', 'private-link-service'), '2019-10-01').outputs.privateLinkServiceResourceId.value]"
            },
            "privateLinkResourceType": {
              "value": ""
            },
            "privateEndpointLocation": {
              "value": "eastus"
            }
          },
          "template": {
            "contentVersion": "1.0.0.0",
            "parameters": {
              "originHostName": {
                "type": "string",
                "metadata": {
                  "description": "The host name that should be used when connecting to the origin."
                }
              },
              "originPath": {
                "type": "string",
                "defaultValue": "",
                "metadata": {
                  "description": "The path that should be used when connecting to the origin."
                }
              },
              "endpointName": {
                "type": "string",
                "metadata": {
                  "description": "The name of the Front Door endpoint to create. This must be globally unique."
                }
              },
              "skuName": {
                "type": "string",
                "allowedValues": [
                  "Standard_AzureFrontDoor",
                  "Premium_AzureFrontDoor"
                ],
                "metadata": {
                  "description": "The name of the SKU to use when creating the Front Door profile. If you use Private Link this must be set to `Premium_AzureFrontDoor`."
                }
              },
              "originForwardingProtocol": {
                "type": "string",
                "defaultValue": "HttpsOnly",
                "allowedValues": [
                  "HttpOnly",
                  "HttpsOnly",
                  "MatchRequest"
                ],
                "metadata": {
                  "description": "The protocol that should be used when connecting from Front Door to the origin."
                }
              },
              "privateEndpointResourceId": {
                "type": "string",
                "defaultValue": "",
                "metadata": {
                  "description": "If you are using Private Link to connect to the origin, this should specify the resource ID of the Private Link resource (e.g. an App Service application, Azure Storage account, etc). If you are not using Private Link then this should be empty."
                }
              },
              "privateLinkResourceType": {
                "type": "string",
                "defaultValue": "",
                "metadata": {
                  "description": "If you are using Private Link to connect to the origin, this should specify the resource type of the Private Link resource. The allowed value will depend on the specific Private Link resource type you are using. If you are not using Private Link then this should be empty."
                }
              },
              "privateEndpointLocation": {
                "type": "string",
                "defaultValue": "",
                "metadata": {
                  "description": "If you are using Private Link to connect to the origin, this should specify the location of the Private Link resource. If you are not using Private Link then this should be empty."
                }
              }
            },
            "functions": [],
            "variables": {
              "isPrivateLinkOrigin": "[not(equals(parameters('privateEndpointResourceId'), ''))]",
              "privateLinkOriginDetails": {
                "privateLink": {
                  "id": "privateEndpointResourceId"
                },
                "groupId": "[if(not(equals(parameters('privateLinkResourceType'), '')), parameters('privateLinkResourceType'), null())]",
                "privateLinkLocation": "privateEndpointLocation",
                "requestMessage": "Please approve this connection."
              },
              "profileName": "MyFrontDoor",
              "originGroupName": "MyOriginGroup",
              "originName": "MyOrigin",
              "routeName": "MyRoute"
            },
            "resources": [
              {
                "type": "Microsoft.Cdn/profiles",
                "apiVersion": "2020-09-01",
                "name": "profileName",
                "location": "global",
                "sku": {
                  "name": "skuName"
                }
              },
              {
                "type": "Microsoft.Cdn/profiles/afdEndpoints",
                "apiVersion": "2020-09-01",
                "name": "[format('{0}/{1}', variables('profileName'), parameters('endpointName'))]",
                "location": "global",
                "properties": {
                  "originResponseTimeoutSeconds": 240,
                  "enabledState": "Enabled"
                },
                "dependsOn": [
                  "Microsoft.Cdn/profiles/profileName"
                ]
              },
              {
                "type": "Microsoft.Cdn/profiles/originGroups",
                "apiVersion": "2020-09-01",
                "name": "[format('{0}/{1}', variables('profileName'), variables('originGroupName'))]",
                "properties": {
                  "loadBalancingSettings": {
                    "sampleSize": 4,
                    "successfulSamplesRequired": 3
                  },
                  "healthProbeSettings": {
                    "probePath": "/",
                    "probeRequestType": "HEAD",
                    "probeProtocol": "Http",
                    "probeIntervalInSeconds": 100
                  }
                },
                "dependsOn": [
                  "Microsoft.Cdn/profiles/profileName"
                ]
              },
              {
                "type": "Microsoft.Cdn/profiles/originGroups/origins",
                "apiVersion": "2020-09-01",
                "name": "[format('{0}/{1}/{2}', variables('profileName'), variables('originGroupName'), variables('originName'))]",
                "properties": {
                  "hostName": "originHostName",
                  "httpPort": 80,
                  "httpsPort": 443,
                  "originHostHeader": "[reference(resourceId('Microsoft.Cdn/profiles/afdEndpoints', variables('profileName'), parameters('endpointName'))).hostName]",
                  "priority": 1,
                  "weight": 1000,
                  "sharedPrivateLinkResource": "[if(variables('isPrivateLinkOrigin'), variables('privateLinkOriginDetails'), null())]"
                },
                "dependsOn": [
                  "Microsoft.Cdn/profiles/afdEndpoints/profileName/endpointName",
                  "Microsoft.Cdn/profiles/originGroups/profileName/originGroupName",
                  "Microsoft.Cdn/profiles/profileName"
                ]
              },
              {
                "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
                "apiVersion": "2020-09-01",
                "name": "[format('{0}/{1}/{2}', variables('profileName'), parameters('endpointName'), variables('routeName'))]",
                "properties": {
                  "originGroup": {
                    "id": "Microsoft.Cdn/profiles/originGroups/profileName/originGroupName"
                  },
                  "originPath": "[if(not(equals(parameters('originPath'), '')), parameters('originPath'), null())]",
                  "supportedProtocols": [
                    "Http",
                    "Https"
                  ],
                  "patternsToMatch": [
                    "/*"
                  ],
                  "compressionSettings": {
                    "contentTypesToCompress": [
                      "application/eot",
                      "application/font",
                      "application/font-sfnt",
                      "application/javascript",
                      "application/json",
                      "application/opentype",
                      "application/otf",
                      "application/pkcs7-mime",
                      "application/truetype",
                      "application/ttf",
                      "application/vnd.ms-fontobject",
                      "application/xhtml+xml",
                      "application/xml",
                      "application/xml+rss",
                      "application/x-font-opentype",
                      "application/x-font-truetype",
                      "application/x-font-ttf",
                      "application/x-httpd-cgi",
                      "application/x-javascript",
                      "application/x-mpegurl",
                      "application/x-opentype",
                      "application/x-otf",
                      "application/x-perl",
                      "application/x-ttf",
                      "font/eot",
                      "font/ttf",
                      "font/otf",
                      "font/opentype",
                      "image/svg+xml",
                      "text/css",
                      "text/csv",
                      "text/html",
                      "text/javascript",
                      "text/js",
                      "text/plain",
                      "text/richtext",
                      "text/tab-separated-values",
                      "text/xml",
                      "text/x-script",
                      "text/x-component",
                      "text/x-java-source"
                    ],
                    "isCompressionEnabled": true
                  },
                  "queryStringCachingBehavior": "IgnoreQueryString",
                  "forwardingProtocol": "originForwardingProtocol",
                  "linkToDefaultDomain": "Enabled",
                  "httpsRedirect": "Enabled"
                },
                "dependsOn": [
                  "Microsoft.Cdn/profiles/afdEndpoints/profileName/endpointName",
                  "Microsoft.Cdn/profiles/originGroups/origins/profileName/originGroupName/originName",
                  "Microsoft.Cdn/profiles/originGroups/profileName/originGroupName",
                  "Microsoft.Cdn/profiles/profileName"
                ]
              }
            ],
            "outputs": {
              "frontDoorEndpointHostName": {
                "type": "string",
                "value": "[reference(resourceId('Microsoft.Cdn/profiles/afdEndpoints', variables('profileName'), parameters('endpointName'))).hostName]"
              },
              "frontDoorId": {
                "type": "string",
                "value": "[reference(resourceId('Microsoft.Cdn/profiles', variables('profileName'))).frontdoorId]"
              }
            },
            "\uff04schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#"
          }
        },
        "dependsOn": [
          "Microsoft.Resources/deployments/load-balancer",
          "Microsoft.Resources/deployments/private-link-service"
        ]
      }
    ],
    "outputs": {
      "frontDoorEndpointHostName": {
        "type": "string",
        "value": "[reference(resourceId('Microsoft.Resources/deployments', 'front-door'), '2019-10-01').outputs.frontDoorEndpointHostName.value]"
      }
    },
    "metadata": {
      "_generator": {
        "name": "bicep",
        "version": "0.3.126.58533",
        "templateHash": "11026282578573497498"
      }
    },
    "\uff04schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#"
  }
}