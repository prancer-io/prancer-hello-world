{
  "structure": "filesystem",
  "error": null,
  "reference": "master",
  "contentType": "json",
  "source": "gitConnectorAzureQuickStart",
  "paths": [
    "/application-workloads/mysql/mysql-paas-replication/azuredeploy.json",
    "/application-workloads/mysql/mysql-paas-replication/azuredeploy.parameters.json"
  ],
  "timestamp": 1642962892246,
  "queryuser": null,
  "checksum": "99914b932bd37a50b983c5e7c90ae93b",
  "node": {
    "masterSnapshotId": "ARM_TEMPLATE_SNAPSHOT",
    "type": "arm",
    "collection": "armtemplate",
    "paths": [
      "/application-workloads/mysql/mysql-paas-replication/azuredeploy.json",
      "/application-workloads/mysql/mysql-paas-replication/azuredeploy.parameters.json"
    ],
    "snapshotId": "ARM_TEMPLATE_SNAPSHOT317",
    "status": "active",
    "validate": true,
    "resourceTypes": [
      "microsoft.resources/deployments"
    ]
  },
  "snapshotId": "ARM_TEMPLATE_SNAPSHOT317",
  "collection": "armtemplate",
  "json": {
    "contentVersion": "1.0.0.0",
    "parameters": {
      "serverName": {
        "type": "string",
        "defaultValue": "[uniqueString(resourceGroup().id)]",
        "metadata": {
          "description": "Server name for the MySQL PaaS instance and it's replicas (replicas will get a '-' attached to the end with the replica number)."
        },
        "value": "GEN-UNIQUE-10"
      },
      "location": {
        "type": "string",
        "defaultValue": "[resourceGroup().location]",
        "metadata": {
          "description": "Location for the MySQL PaaS components to be deployed."
        }
      },
      "administratorLogin": {
        "type": "string",
        "metadata": {
          "description": "Administrator name for MySQL servers."
        },
        "value": "GEN-UNIQUE-10"
      },
      "administratorLoginPassword": {
        "type": "securestring",
        "metadata": {
          "description": "Password for the MySQL server administrator."
        },
        "value": "GEN-PASSWORD"
      },
      "vCPU": {
        "type": "int",
        "defaultValue": 2,
        "metadata": {
          "description": "Number of vCPUs for the MySQL Server instances to be deployed."
        }
      },
      "skuFamily": {
        "type": "string",
        "defaultValue": "Gen5",
        "allowedValues": [
          "Gen4",
          "Gen5"
        ],
        "metadata": {
          "description": "Hardware generation for the MySQL Server instances to be deployed."
        }
      },
      "skuSizeMB": {
        "type": "int",
        "defaultValue": 5120,
        "minValue": 5120,
        "maxValue": 10240,
        "metadata": {
          "description": "Storage capacity for the MySQL Server instances to be deployed."
        }
      },
      "skuTier": {
        "type": "string",
        "defaultValue": "GeneralPurpose",
        "allowedValues": [
          "Basic",
          "GeneralPurpose",
          "MemoryOptimized"
        ],
        "metadata": {
          "description": "Performance tier for the MySQL Server instances to be deployed."
        }
      },
      "numberOfReplicas": {
        "type": "int",
        "defaultValue": 1,
        "allowedValues": [
          0,
          1,
          2,
          3,
          4,
          5
        ],
        "metadata": {
          "description": "Number of replica instances to be deployed."
        }
      },
      "version": {
        "type": "string",
        "defaultValue": "5.7",
        "allowedValues": [
          "5.6",
          "5.7"
        ],
        "metadata": {
          "description": "MySQL version for the MySQL Server instances to be deployed."
        }
      },
      "enableAzureResources": {
        "type": "bool",
        "defaultValue": true,
        "metadata": {
          "description": "Enable Azure hosted resources to access the master instance."
        }
      },
      "backupRetentionDays": {
        "type": "int",
        "defaultValue": 7,
        "minvalue": 7,
        "maxvalue": 35,
        "metadata": {
          "description": "Backup retention period."
        }
      },
      "geoRedundantBackup": {
        "type": "string",
        "defaultValue": "Disabled",
        "allowedValues": [
          "Enabled",
          "Disabled"
        ],
        "metadata": {
          "description": "Enable or disable geo redundant backups."
        }
      },
      "_artifactsLocation": {
        "type": "string",
        "metadata": {
          "description": "The base URI where artifacts required by this template are located including a trailing '/'"
        },
        "defaultValue": "[deployment().properties.templatelink.uri]"
      },
      "_artifactsLocationSasToken": {
        "type": "securestring",
        "defaultValue": "",
        "metadata": {
          "description": "The sasToken required to access _artifactsLocation.  When the template is deployed using the accompanying scripts, a sasToken will be automatically generated. Use the defaultValue if the staging location is not secured."
        }
      }
    },
    "variables": {
      "nestedtemplateMySQL": "[uri(parameters('_artifactsLocation'), concat('nested/mysql.json', parameters('_artifactsLocationSasToken')))]",
      "nestedtemplateMySQLReplica": "[uri(parameters('_artifactsLocation'), concat('nested/mysqlReplica.json', parameters('_artifactsLocationSasToken')))]",
      "sourceServerId": "Microsoft.DBforMySQL/servers/GEN-UNIQUE-10",
      "skuName": "[concat(if(equals(parameters('skuTier'),'GeneralPurpose'),'GP',if(equals(parameters('skuTier'),'Basic'),'B',if(equals(parameters('skuTier'),'MemoryOptimized'),'MO',''))),'_',parameters('skuFamily'),'_',parameters('vCPU'))]",
      "sku": {
        "name": "[variables('skuName')]",
        "tier": "GeneralPurpose",
        "capacity": 2,
        "size": 5120,
        "family": "Gen5"
      }
    },
    "resources": [
      {
        "apiVersion": "2020-06-01",
        "name": "MySQLServer",
        "type": "Microsoft.Resources/deployments",
        "properties": {
          "mode": "Incremental",
          "templateLink": {
            "uri": "[uri(parameters('_artifactsLocation'), concat('nested/mysql.json', parameters('_artifactsLocationSasToken')))]"
          },
          "parameters": {
            "sku": {
              "value": {
                "name": "[variables('skuName')]",
                "tier": "GeneralPurpose",
                "capacity": 2,
                "size": 5120,
                "family": "Gen5"
              }
            },
            "serverName": {
              "value": "GEN-UNIQUE-10"
            },
            "location": {
              "value": "[resourceGroup().location]"
            },
            "version": {
              "value": "5.7"
            },
            "administratorLogin": {
              "value": "GEN-UNIQUE-10"
            },
            "administratorLoginPassword": {
              "value": "GEN-PASSWORD"
            },
            "backupRetentionDays": {
              "value": 7
            },
            "geoRedundantBackup": {
              "value": "Disabled"
            },
            "enableAzureResources": {
              "value": true
            },
            "ServerId": {
              "value": "Microsoft.DBforMySQL/servers/GEN-UNIQUE-10"
            }
          }
        }
      },
      {
        "apiVersion": "2020-06-01",
        "name": "MySQLServerReplicas",
        "type": "Microsoft.Resources/deployments",
        "condition": "[greater(parameters('numberOfReplicas'),0)]",
        "dependsOn": [
          "MySQLServer"
        ],
        "properties": {
          "mode": "Incremental",
          "templateLink": {
            "uri": "[uri(parameters('_artifactsLocation'), concat('nested/mysqlReplica.json', parameters('_artifactsLocationSasToken')))]"
          },
          "parameters": {
            "sku": {
              "value": {
                "name": "[variables('skuName')]",
                "tier": "GeneralPurpose",
                "capacity": 2,
                "size": 5120,
                "family": "Gen5"
              }
            },
            "serverName": {
              "value": "GEN-UNIQUE-10"
            },
            "location": {
              "value": "[resourceGroup().location]"
            },
            "numberOfReplicas": {
              "value": 1
            },
            "backupRetentionDays": {
              "value": 7
            },
            "geoRedundantBackup": {
              "value": "Disabled"
            },
            "sourceServerId": {
              "value": "Microsoft.DBforMySQL/servers/GEN-UNIQUE-10"
            }
          }
        }
      }
    ],
    "outputs": {},
    "\uff04schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#"
  }
}