{
  "structure": "filesystem",
  "error": null,
  "reference": "master",
  "contentType": "json",
  "source": "gitConnectorAzureQuickStart",
  "paths": [
    "/demos/e-shop-website-with-ilb-ase/azuredeploy.json",
    "/demos/e-shop-website-with-ilb-ase/azuredeploy.parameters.json"
  ],
  "timestamp": 1642962899344,
  "queryuser": null,
  "checksum": "99914b932bd37a50b983c5e7c90ae93b",
  "node": {
    "masterSnapshotId": "ARM_TEMPLATE_SNAPSHOT",
    "type": "arm",
    "collection": "armtemplate",
    "paths": [
      "/demos/e-shop-website-with-ilb-ase/azuredeploy.json",
      "/demos/e-shop-website-with-ilb-ase/azuredeploy.parameters.json"
    ],
    "snapshotId": "ARM_TEMPLATE_SNAPSHOT709",
    "status": "active",
    "validate": true,
    "resourceTypes": [
      "microsoft.network/publicipaddresses",
      "microsoft.web/sites",
      "microsoft.cdn/profiles",
      "microsoft.sql/servers",
      "microsoft.cache/redis",
      "microsoft.network/virtualnetworks/subnets",
      "microsoft.network/applicationgateways",
      "microsoft.storage/storageaccounts",
      "microsoft.web/serverfarms",
      "microsoft.insights/components"
    ]
  },
  "snapshotId": "ARM_TEMPLATE_SNAPSHOT709",
  "collection": "armtemplate",
  "json": {
    "contentVersion": "1.0.0.0",
    "parameters": {
      "existingASEName": {
        "type": "string",
        "metadata": {
          "description": "Name of the App Service Environment."
        },
        "value": "GET-PREREQ-existingASEName"
      },
      "existingASELocation": {
        "type": "string",
        "metadata": {
          "description": "Location of the App Service Environment."
        },
        "value": "GET-PREREQ-existingASELocation"
      },
      "existingASEDNSSuffix": {
        "type": "string",
        "metadata": {
          "description": "DNS Suffix used for the ILB ASE"
        },
        "value": "internal-contoso.com"
      },
      "dnsSuffix": {
        "type": "string",
        "metadata": {
          "description": "Root domain name used to access web apps on internet."
        },
        "value": "contoso.com"
      },
      "sqlServerAdministratorLogin": {
        "type": "string",
        "metadata": {
          "description": "Administrator login name of the Azure SQL Server."
        },
        "value": "GEN-UNIQUE"
      },
      "sqlServerAdministratorLoginPassword": {
        "type": "securestring",
        "metadata": {
          "description": "Administrator login password of the Azure SQL Server."
        },
        "value": "GEN-PASSWORD"
      },
      "azureAdTenantId": {
        "type": "string",
        "metadata": {
          "description": "Directory ID of the Azure Active Directory used by the Admin App."
        },
        "value": "GEN-UNIQUE"
      },
      "azureAdClientId": {
        "type": "string",
        "metadata": {
          "description": "Application ID of the Admin App Registration."
        },
        "value": "GEN-UNIQUE"
      },
      "appInsightsLocation": {
        "type": "string",
        "metadata": {
          "description": "description"
        },
        "value": "East US"
      }
    },
    "variables": {
      "location": "existingAseLocation",
      "vnetName": "existingAseName-vnet",
      "aseSubnetName": "existingAseName-subnet",
      "aseSubnetAddressPrefix": "192.168.251.64/26",
      "agSubnetName": "app-gateway-subnet",
      "aspName": "existingAseName-asp",
      "webAppName": "existingAseName-web",
      "contentAppName": "existingAseName-content",
      "apiAppName": "existingAseName-api",
      "adminAppName": "existingAseName-admin",
      "appInsightsName": "existingAseName-app-insights",
      "sqlServerName": "existingAseName-sql-server",
      "storageAccountName": "[concat(replace(parameters('existingAseName'), '-', ''), '')]",
      "redisCacheName": "existingAseName-cache",
      "redisCacheSubnetName": "redis-cache-subnet",
      "redisCacheSubnetAddressPrefix": "192.168.251.0/26",
      "redisCacheStaticIP": "192.168.251.62",
      "appGatewayName": "existingAseName-waf",
      "appGatewayPublicIPName": "existingAseName-waf-ip",
      "appGatewayPublicIPDnsPrefix": "existingAseName-waf",
      "cdnName": "existingAseName-cdn",
      "cdnWebAppEndpointName": "existingAseName-cdn-web",
      "cdnStorageEndpointName": "existingAseName-cdn-storage",
      "webAppExternalHostName": "existingAseName-web.contoso.com",
      "webAppInternalHostName": "existingAseName-web.internal-contoso.com",
      "apiAppInternalHostName": "existingAseName-api.internal-contoso.com",
      "contentAppExternalHostName": "existingAseName-content.contoso.com",
      "contentAppInternalHostName": "existingAseName-content.internal-contoso.com",
      "adminAppExternalHostName": "existingAseName-admin.contoso.com",
      "adminAppInternalHostName": "existingAseName-admin.internal-contoso.com",
      "sourceCodeRepositoryURL": "https://github.com/OGCanviz/e-shop-website-with-ilb-ase/"
    },
    "resources": [
      {
        "apiVersion": "2020-11-01",
        "type": "Microsoft.Network/virtualNetworks/subnets",
        "name": "existingAseName-vnet/redis-cache-subnet",
        "properties": {
          "addressPrefix": "192.168.251.0/26"
        }
      },
      {
        "apiVersion": "2020-11-01",
        "type": "Microsoft.Network/virtualNetworks/subnets",
        "name": "existingAseName-vnet/app-gateway-subnet",
        "dependsOn": [
          "Microsoft.Network/virtualNetworks/subnets//existingAseName-vnet/redis-cache-subnet"
        ],
        "properties": {
          "addressPrefix": "192.168.251.64/26"
        }
      },
      {
        "apiVersion": "2020-02-02",
        "type": "microsoft.insights/components",
        "name": "existingAseName-app-insights",
        "location": "East US",
        "properties": {
          "Application_Type": "web",
          "Request_Source": "IbizaWebAppExtensionCreate"
        }
      },
      {
        "apiVersion": "2021-04-01",
        "type": "Microsoft.Storage/storageAccounts",
        "name": "[variables('storageAccountName')]",
        "location": "existingAseLocation",
        "sku": {
          "name": "Standard_RAGRS"
        },
        "kind": "StorageV2",
        "properties": {
          "supportsHttpsTrafficOnly": false,
          "accessTier": "Hot",
          "encryption": {
            "services": {
              "blob": {
                "enabled": true
              },
              "file": {
                "enabled": true
              }
            },
            "keySource": "Microsoft.Storage"
          }
        }
      },
      {
        "apiVersion": "2020-06-01",
        "type": "Microsoft.Cache/Redis",
        "name": "existingAseName-cache",
        "location": "existingAseLocation",
        "dependsOn": [
          "Microsoft.Network/virtualNetworks/subnets//existingAseName-vnet/redis-cache-subnet"
        ],
        "properties": {
          "sku": {
            "name": "Premium",
            "family": "P",
            "capacity": 1
          },
          "subnetId": "Microsoft.Network/virtualNetworks/subnets//existingAseName-vnet/redis-cache-subnet",
          "staticIP": "192.168.251.62",
          "enableNonSslPort": true
        }
      },
      {
        "apiVersion": "2019-08-01",
        "type": "Microsoft.Web/serverfarms",
        "name": "existingAseName-asp",
        "location": "existingAseLocation",
        "kind": "app",
        "properties": {
          "name": "existingAseName-asp",
          "workerSize": "0",
          "workerSizeId": "0",
          "numberOfWorkers": "1",
          "reserved": false,
          "hostingEnvironment": "existingAseName"
        },
        "sku": {
          "tier": "Isolated",
          "name": "I1"
        }
      },
      {
        "apiVersion": "2019-08-01",
        "type": "Microsoft.Web/sites",
        "name": "existingAseName-content",
        "location": "existingAseLocation",
        "dependsOn": [
          "Microsoft.Web/serverfarms//existingAseName-asp"
        ],
        "properties": {
          "name": "existingAseName-content",
          "serverFarmId": "Microsoft.Web/serverfarms//existingAseName-asp",
          "hostingEnvironment": "existingAseName",
          "siteConfig": {
            "alwaysOn": true,
            "appSettings": [
              {
                "name": "project",
                "value": "src/Web/wwwroot"
              }
            ]
          }
        },
        "resources": [
          {
            "apiVersion": "2019-08-01",
            "name": "web",
            "type": "sourcecontrols",
            "dependsOn": [
              "Microsoft.Web/sites//existingAseName-content"
            ],
            "properties": {
              "RepoUrl": "https://github.com/OGCanviz/e-shop-website-with-ilb-ase/",
              "branch": "master",
              "IsManualIntegration": true
            }
          }
        ]
      },
      {
        "apiVersion": "2019-08-01",
        "type": "Microsoft.Web/sites",
        "name": "existingAseName-api",
        "location": "existingAseLocation",
        "dependsOn": [
          "Microsoft.Web/serverfarms//existingAseName-asp",
          "microsoft.insights/components//existingAseName-app-insights"
        ],
        "properties": {
          "name": "existingAseName-api",
          "serverFarmId": "Microsoft.Web/serverfarms//existingAseName-asp",
          "hostingEnvironment": "existingAseName",
          "siteConfig": {
            "alwaysOn": true,
            "appSettings": [
              {
                "name": "ApplicationInsights:InstrumentationKey",
                "value": "[reference(resourceId('microsoft.insights/components/', variables('appInsightsName')), '2020-02-02').InstrumentationKey]"
              },
              {
                "name": "project",
                "value": "src/API/API.csproj"
              }
            ],
            "connectionstrings": [
              {
                "name": "SalesConnection",
                "type": "SQLAzure",
                "connectionString": "[concat('Server=tcp:', reference(variables('sqlServerName')).fullyQualifiedDomainName, ',1433;Initial Catalog=Sales;Persist Security Info=False;User ID=', parameters('sqlServerAdministratorLogin'), ';Password=', parameters('sqlServerAdministratorLoginPassword'), ';MultipleActiveResultSets=False;Encrypt=True;TrustServerCertificate=False;Connection Timeout=30;')]"
              }
            ]
          }
        },
        "resources": [
          {
            "apiVersion": "2019-08-01",
            "name": "web",
            "type": "sourcecontrols",
            "dependsOn": [
              "Microsoft.Web/sites//existingAseName-api"
            ],
            "properties": {
              "RepoUrl": "https://github.com/OGCanviz/e-shop-website-with-ilb-ase/",
              "branch": "master",
              "IsManualIntegration": true
            }
          }
        ]
      },
      {
        "apiVersion": "2019-08-01",
        "type": "Microsoft.Web/sites",
        "name": "existingAseName-admin",
        "location": "existingAseLocation",
        "dependsOn": [
          "Microsoft.Web/serverfarms//existingAseName-asp",
          "microsoft.insights/components//existingAseName-app-insights"
        ],
        "properties": {
          "name": "existingAseName-admin",
          "serverFarmId": "Microsoft.Web/serverfarms//existingAseName-asp",
          "hostingEnvironment": "existingAseName",
          "siteConfig": {
            "alwaysOn": true,
            "appSettings": [
              {
                "name": "AzureAd:Domain",
                "value": ""
              },
              {
                "name": "AzureAd:TenantId",
                "value": "GEN-UNIQUE"
              },
              {
                "name": "AzureAd:ClientId",
                "value": "GEN-UNIQUE"
              },
              {
                "name": "ODataServiceBaseUrl",
                "value": "http://existingAseName-api.internal-contoso.com"
              },
              {
                "name": "ApplicationInsights:InstrumentationKey",
                "value": "[reference(resourceId('microsoft.insights/components/', variables('appInsightsName')), '2020-02-02').InstrumentationKey]"
              },
              {
                "name": "project",
                "value": "src/Admin/Admin.csproj"
              }
            ]
          }
        },
        "resources": [
          {
            "apiVersion": "2019-08-01",
            "name": "web",
            "type": "sourcecontrols",
            "dependsOn": [
              "Microsoft.Web/sites//existingAseName-admin",
              "Microsoft.Web/sites/sourcecontrols//existingAseName-api/web"
            ],
            "properties": {
              "RepoUrl": "https://github.com/OGCanviz/e-shop-website-with-ilb-ase/",
              "branch": "master",
              "IsManualIntegration": true
            }
          }
        ]
      },
      {
        "apiVersion": "2019-08-01",
        "type": "Microsoft.Web/sites",
        "name": "existingAseName-web",
        "location": "existingAseLocation",
        "dependsOn": [
          "[resourceId('Microsoft.Web/serverfarms/', variables('aspName'))]",
          "[resourceId('microsoft.insights/components/', variables('appInsightsName'))]",
          "[resourceId('Microsoft.Storage/storageAccounts', variables('storageAccountName'))]",
          "[resourceId('Microsoft.Cache/Redis/', variables('redisCacheName'))]"
        ],
        "properties": {
          "name": "existingAseName-web",
          "serverFarmId": "Microsoft.Web/serverfarms//existingAseName-asp",
          "hostingEnvironment": "existingAseName",
          "siteConfig": {
            "alwaysOn": true,
            "appSettings": [
              {
                "name": "ODataServiceBaseUrl",
                "value": "http://existingAseName-api.internal-contoso.com"
              },
              {
                "name": "cdn:url",
                "value": "[concat('http://', reference(resourceId('microsoft.cdn/profiles/endpoints/', variables('cdnName'), variables('cdnWebAppEndpointName')), '2020-09-01').hostName)]"
              },
              {
                "name": "CatalogBaseUrl",
                "value": "https://existingAseName-cdn-storage.azureedge.net"
              },
              {
                "name": "ApplicationInsights:InstrumentationKey",
                "value": "[reference(resourceId('microsoft.insights/components/', variables('appInsightsName')), '2020-02-02').InstrumentationKey]"
              },
              {
                "name": "project",
                "value": "src/Web/Web.csproj"
              }
            ],
            "connectionstrings": [
              {
                "name": "CatalogConnection",
                "type": "SQLAzure",
                "connectionString": "[concat('Server=tcp:', reference(variables('sqlServerName')).fullyQualifiedDomainName, ',1433;Initial Catalog=Catalog;Persist Security Info=False;User ID=', parameters('sqlServerAdministratorLogin'), ';Password=', parameters('sqlServerAdministratorLoginPassword'), ';MultipleActiveResultSets=False;Encrypt=True;TrustServerCertificate=False;Connection Timeout=30;')]"
              },
              {
                "name": "SalesConnection",
                "type": "SQLAzure",
                "connectionString": "[concat('Server=tcp:', reference(variables('sqlServerName')).fullyQualifiedDomainName, ',1433;Initial Catalog=Sales;Persist Security Info=False;User ID=', parameters('sqlServerAdministratorLogin'), ';Password=', parameters('sqlServerAdministratorLoginPassword'), ';MultipleActiveResultSets=False;Encrypt=True;TrustServerCertificate=False;Connection Timeout=30;')]"
              },
              {
                "name": "IdentityConnection",
                "type": "SQLAzure",
                "connectionString": "[concat('Server=tcp:', reference(variables('sqlServerName')).fullyQualifiedDomainName, ',1433;Initial Catalog=Identity;Persist Security Info=False;User ID=', parameters('sqlServerAdministratorLogin'), ';Password=', parameters('sqlServerAdministratorLoginPassword'), ';MultipleActiveResultSets=False;Encrypt=True;TrustServerCertificate=False;Connection Timeout=30;')]"
              },
              {
                "name": "StorageConnection",
                "type": "Custom",
                "connectionString": "[concat('DefaultEndpointsProtocol=https;AccountName=',variables('storageAccountName'),';AccountKey=',listkeys(resourceId('Microsoft.Storage/storageAccounts/', variables('storageAccountName')), '2021-04-01').keys[0].value,';')]"
              },
              {
                "name": "RedisConnection",
                "type": "Custom",
                "connectionString": "[concat(variables('redisCacheName'), '.redis.cache.windows.net:6380,password=', listKeys(resourceId('Microsoft.Cache/Redis/', variables('redisCacheName')), '2020-06-01').primaryKey, ',ssl=True,abortConnect=False')]"
              }
            ]
          }
        },
        "resources": [
          {
            "apiVersion": "2019-08-01",
            "name": "web",
            "type": "sourcecontrols",
            "dependsOn": [
              "Microsoft.Web/sites//existingAseName-web",
              "Microsoft.Web/sites/sourcecontrols//existingAseName-admin/web"
            ],
            "properties": {
              "RepoUrl": "https://github.com/OGCanviz/e-shop-website-with-ilb-ase/",
              "branch": "master",
              "IsManualIntegration": true
            }
          }
        ]
      },
      {
        "apiVersion": "2020-11-01-preview",
        "type": "Microsoft.Sql/servers",
        "location": "existingAseLocation",
        "name": "existingAseName-sql-server",
        "properties": {
          "administratorLogin": "GEN-UNIQUE",
          "administratorLoginPassword": "GEN-PASSWORD",
          "version": "12.0"
        },
        "resources": [
          {
            "apiVersion": "2020-11-01-preview",
            "type": "databases",
            "location": "existingAseLocation",
            "name": "Catalog",
            "dependsOn": [
              "Microsoft.Sql/servers//existingAseName-sql-server"
            ],
            "properties": {
              "collation": "SQL_Latin1_General_CP1_CI_AS",
              "edition": "Basic",
              "zoneRedundant": false
            }
          },
          {
            "apiVersion": "2020-11-01-preview",
            "type": "databases",
            "location": "existingAseLocation",
            "name": "Sales",
            "dependsOn": [
              "Microsoft.Sql/servers//existingAseName-sql-server"
            ],
            "properties": {
              "collation": "SQL_Latin1_General_CP1_CI_AS",
              "edition": "Basic",
              "zoneRedundant": false
            }
          },
          {
            "apiVersion": "2020-11-01-preview",
            "type": "databases",
            "location": "existingAseLocation",
            "name": "Identity",
            "dependsOn": [
              "Microsoft.Sql/servers//existingAseName-sql-server"
            ],
            "properties": {
              "collation": "SQL_Latin1_General_CP1_CI_AS",
              "edition": "Basic",
              "zoneRedundant": false
            }
          },
          {
            "apiVersion": "2020-11-01-preview",
            "type": "virtualNetworkRules",
            "name": "allow-access-from-existingAseName-subnet",
            "dependsOn": [
              "Microsoft.Sql/servers//existingAseName-sql-server"
            ],
            "properties": {
              "virtualNetworkSubnetId": "Microsoft.Network/virtualNetworks/subnets//existingAseName-vnet/existingAseName-subnet"
            }
          }
        ]
      },
      {
        "apiVersion": "2020-11-01",
        "type": "Microsoft.Network/applicationGateways",
        "name": "existingAseName-waf",
        "location": "existingAseLocation",
        "dependsOn": [
          "Microsoft.Network/virtualNetworks/subnets//existingAseName-vnet/app-gateway-subnet",
          "Microsoft.Network/publicIPAddresses//existingAseName-waf-ip"
        ],
        "properties": {
          "sku": {
            "name": "WAF_Medium",
            "tier": "WAF",
            "capacity": 1
          },
          "gatewayIPConfigurations": [
            {
              "name": "appGatewayIpConfig",
              "properties": {
                "subnet": {
                  "id": "Microsoft.Network/virtualNetworks/subnets//existingAseName-vnet/app-gateway-subnet"
                }
              }
            }
          ],
          "frontendIPConfigurations": [
            {
              "name": "appGatewayFrontendIP",
              "properties": {
                "PublicIPAddress": {
                  "id": "Microsoft.Network/publicIPAddresses//existingAseName-waf-ip"
                }
              }
            }
          ],
          "frontendPorts": [
            {
              "name": "appGatewayFrontendPort",
              "properties": {
                "Port": 80
              }
            }
          ],
          "backendAddressPools": [
            {
              "name": "webAppBackendPool",
              "properties": {
                "BackendAddresses": [
                  {
                    "fqdn": "existingAseName-web.internal-contoso.com"
                  }
                ]
              }
            },
            {
              "name": "contentAppBackendPool",
              "properties": {
                "BackendAddresses": [
                  {
                    "fqdn": "existingAseName-content.internal-contoso.com"
                  }
                ]
              }
            },
            {
              "name": "adminAppBackendPool",
              "properties": {
                "BackendAddresses": [
                  {
                    "fqdn": "existingAseName-admin.internal-contoso.com"
                  }
                ]
              }
            }
          ],
          "backendHttpSettingsCollection": [
            {
              "name": "webAppBackendHttpSettings",
              "properties": {
                "Port": 80,
                "Protocol": "Http",
                "CookieBasedAffinity": "Disabled",
                "PickHostNameFromBackendAddress": false,
                "probe": {
                  "id": "Microsoft.Network/applicationGateways/probes/existingAseName-waf/webAppProbe"
                }
              }
            },
            {
              "name": "contentAppBackendHttpSettings",
              "properties": {
                "Port": 80,
                "Protocol": "Http",
                "CookieBasedAffinity": "Disabled",
                "PickHostNameFromBackendAddress": false,
                "probe": {
                  "id": "Microsoft.Network/applicationGateways/probes/existingAseName-waf/contentAppProbe"
                }
              }
            },
            {
              "name": "adminAppBackendHttpSettings",
              "properties": {
                "Port": 80,
                "Protocol": "Http",
                "CookieBasedAffinity": "Disabled",
                "PickHostNameFromBackendAddress": false,
                "probe": {
                  "id": "Microsoft.Network/applicationGateways/probes/existingAseName-waf/adminAppProbe"
                }
              }
            }
          ],
          "httpListeners": [
            {
              "name": "webAppHttpListener",
              "properties": {
                "FrontendIPConfiguration": {
                  "id": "Microsoft.Network/applicationGateways/frontendIPConfigurations/existingAseName-waf/appGatewayFrontendIP"
                },
                "FrontendPort": {
                  "id": "Microsoft.Network/applicationGateways/frontendPorts/existingAseName-waf/appGatewayFrontendPort"
                },
                "Protocol": "Http",
                "HostName": "existingAseName-web.contoso.com"
              }
            },
            {
              "name": "contentAppHttpListener",
              "properties": {
                "FrontendIPConfiguration": {
                  "id": "Microsoft.Network/applicationGateways/frontendIPConfigurations/existingAseName-waf/appGatewayFrontendIP"
                },
                "FrontendPort": {
                  "id": "Microsoft.Network/applicationGateways/frontendPorts/existingAseName-waf/appGatewayFrontendPort"
                },
                "Protocol": "Http",
                "HostName": "existingAseName-content.contoso.com"
              }
            },
            {
              "name": "adminAppHttpListener",
              "properties": {
                "FrontendIPConfiguration": {
                  "id": "Microsoft.Network/applicationGateways/frontendIPConfigurations/existingAseName-waf/appGatewayFrontendIP"
                },
                "FrontendPort": {
                  "id": "Microsoft.Network/applicationGateways/frontendPorts/existingAseName-waf/appGatewayFrontendPort"
                },
                "Protocol": "Http",
                "HostName": "existingAseName-admin.contoso.com"
              }
            }
          ],
          "requestRoutingRules": [
            {
              "Name": "webAppRule",
              "properties": {
                "RuleType": "Basic",
                "httpListener": {
                  "id": "Microsoft.Network/applicationGateways/httpListeners/existingAseName-waf/webAppHttpListener"
                },
                "backendAddressPool": {
                  "id": "Microsoft.Network/applicationGateways/backendAddressPools/existingAseName-waf/webAppBackendPool"
                },
                "backendHttpSettings": {
                  "id": "Microsoft.Network/applicationGateways/backendHttpSettingsCollection/existingAseName-waf/webAppBackendHttpSettings"
                }
              }
            },
            {
              "Name": "contentAppRule",
              "properties": {
                "RuleType": "Basic",
                "httpListener": {
                  "id": "Microsoft.Network/applicationGateways/httpListeners/existingAseName-waf/contentAppHttpListener"
                },
                "backendAddressPool": {
                  "id": "Microsoft.Network/applicationGateways/backendAddressPools/existingAseName-waf/contentAppBackendPool"
                },
                "backendHttpSettings": {
                  "id": "Microsoft.Network/applicationGateways/backendHttpSettingsCollection/existingAseName-waf/contentAppBackendHttpSettings"
                }
              }
            },
            {
              "Name": "adminAppRule",
              "properties": {
                "RuleType": "Basic",
                "httpListener": {
                  "id": "Microsoft.Network/applicationGateways/httpListeners/existingAseName-waf/adminAppHttpListener"
                },
                "backendAddressPool": {
                  "id": "Microsoft.Network/applicationGateways/backendAddressPools/existingAseName-waf/adminAppBackendPool"
                },
                "backendHttpSettings": {
                  "id": "Microsoft.Network/applicationGateways/backendHttpSettingsCollection/existingAseName-waf/adminAppBackendHttpSettings"
                }
              }
            }
          ],
          "probes": [
            {
              "name": "webAppProbe",
              "properties": {
                "protocol": "Http",
                "path": "/",
                "host": "existingAseName-web.internal-contoso.com",
                "interval": 30,
                "timeout": 120,
                "unhealthyThreshold": 3,
                "pickHostNameFromBackendHttpSettings": false
              }
            },
            {
              "name": "contentAppProbe",
              "properties": {
                "protocol": "Http",
                "path": "/",
                "host": "existingAseName-content.internal-contoso.com",
                "interval": 30,
                "timeout": 120,
                "unhealthyThreshold": 3,
                "pickHostNameFromBackendHttpSettings": false
              }
            },
            {
              "name": "adminAppProbe",
              "properties": {
                "protocol": "Http",
                "path": "/",
                "host": "existingAseName-admin.internal-contoso.com",
                "interval": 30,
                "timeout": 120,
                "unhealthyThreshold": 3,
                "pickHostNameFromBackendHttpSettings": false
              }
            }
          ],
          "webApplicationFirewallConfiguration": {
            "enabled": true,
            "firewallMode": "Prevention",
            "ruleSetType": "OWASP",
            "ruleSetVersion": "3.0",
            "disabledRuleGroups": [
              {
                "ruleGroupName": "REQUEST-920-PROTOCOL-ENFORCEMENT",
                "rules": [
                  920350
                ]
              },
              {
                "ruleGroupName": "REQUEST-931-APPLICATION-ATTACK-RFI",
                "rules": [
                  931130
                ]
              },
              {
                "ruleGroupName": "REQUEST-942-APPLICATION-ATTACK-SQLI",
                "rules": [
                  942130,
                  942440
                ]
              }
            ]
          }
        }
      },
      {
        "apiVersion": "2020-11-01",
        "type": "Microsoft.Network/publicIPAddresses",
        "name": "existingAseName-waf-ip",
        "location": "existingAseLocation",
        "properties": {
          "publicIPAllocationMethod": "Dynamic",
          "dnsSettings": {
            "domainNameLabel": "existingAseName-waf"
          }
        }
      },
      {
        "apiVersion": "2020-09-01",
        "type": "microsoft.cdn/profiles",
        "name": "existingAseName-cdn",
        "location": "existingAseLocation",
        "sku": {
          "name": "standard_verizon"
        },
        "resources": [
          {
            "apiVersion": "2020-09-01",
            "type": "endpoints",
            "name": "existingAseName-cdn-web",
            "location": "existingAseLocation",
            "dependsOn": [
              "microsoft.cdn/profiles//existingAseName-cdn"
            ],
            "properties": {
              "isHttpAllowed": true,
              "isHttpsAllowed": false,
              "origins": [
                {
                  "name": "contentApp",
                  "properties": {
                    "hostName": "existingAseName-content.contoso.com"
                  }
                }
              ],
              "isCompressionEnabled": true,
              "contentTypesToCompress": [
                "text/plain",
                "text/html",
                "text/css",
                "text/javascript",
                "application/x-javascript",
                "application/javascript",
                "application/json",
                "application/xml"
              ],
              "optimizationType": "GeneralWebDelivery",
              "originHostHeader": "existingAseName-content.contoso.com"
            }
          },
          {
            "apiVersion": "2020-09-01",
            "type": "endpoints",
            "name": "existingAseName-cdn-storage",
            "location": "existingAseLocation",
            "dependsOn": [
              "[resourceId('microsoft.cdn/profiles/', variables('cdnName'))]",
              "[resourceId('Microsoft.Storage/storageAccounts/', variables('storageAccountName'))]"
            ],
            "properties": {
              "isHttpAllowed": true,
              "isHttpsAllowed": true,
              "origins": [
                {
                  "name": "Storage",
                  "properties": {
                    "hostName": "[replace(replace(reference(resourceId('Microsoft.Storage/storageAccounts', variables('storageAccountName')), '2021-04-01').primaryEndpoints.blob, 'https://', ''), '/', '')]"
                  }
                }
              ],
              "isCompressionEnabled": true,
              "contentTypesToCompress": [
                "text/plain",
                "text/html",
                "text/css",
                "text/javascript",
                "application/x-javascript",
                "application/javascript",
                "application/json",
                "application/xml"
              ],
              "optimizationType": "GeneralWebDelivery",
              "originHostHeader": "[replace(replace(reference(resourceId('Microsoft.Storage/storageAccounts', variables('storageAccountName')), '2021-04-01').primaryEndpoints.blob, 'https://', ''), '/', '')]"
            }
          }
        ]
      }
    ],
    "outputs": {
      "webAppURL": {
        "type": "string",
        "value": "[concat('http://', variables('webAppExternalHostName'))]"
      },
      "adminAppURL": {
        "type": "string",
        "value": "[concat('http://', variables('adminAppExternalHostName'))]"
      },
      "adminAppRedirectURL": {
        "type": "string",
        "value": "[concat('http://', variables('adminAppExternalHostName'), '/signin-oidc')]"
      },
      "appGatewayPublicIPFqdn": {
        "type": "string",
        "value": "[reference(resourceId('Microsoft.Network/publicIPAddresses/', variables('appGatewayPublicIPName')), '2020-11-01').dnsSettings.fqdn]"
      }
    },
    "\uff04schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#"
  }
}