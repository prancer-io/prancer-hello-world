{
  "structure": "filesystem",
  "error": null,
  "reference": "master",
  "contentType": "json",
  "source": "gitConnectorAzureQuickStart",
  "paths": [
    "/modules/Microsoft.ManagedIdentity/user-assigned-identity-role-assignment/1.0/azuredeploy.json",
    "/modules/Microsoft.ManagedIdentity/user-assigned-identity-role-assignment/1.0/azuredeploy.parameters.json"
  ],
  "timestamp": 1642962902688,
  "queryuser": null,
  "checksum": "99914b932bd37a50b983c5e7c90ae93b",
  "node": {
    "masterSnapshotId": "ARM_TEMPLATE_SNAPSHOT",
    "type": "arm",
    "collection": "armtemplate",
    "paths": [
      "/modules/Microsoft.ManagedIdentity/user-assigned-identity-role-assignment/1.0/azuredeploy.json",
      "/modules/Microsoft.ManagedIdentity/user-assigned-identity-role-assignment/1.0/azuredeploy.parameters.json"
    ],
    "snapshotId": "ARM_TEMPLATE_SNAPSHOT909",
    "status": "active",
    "validate": true,
    "resourceTypes": [
      "microsoft.authorization/roleassignments",
      "microsoft.managedidentity/userassignedidentities"
    ]
  },
  "snapshotId": "ARM_TEMPLATE_SNAPSHOT909",
  "collection": "armtemplate",
  "json": {
    "contentVersion": "1.0.0.0",
    "metadata": {
      "_generator": {
        "name": "bicep",
        "version": "0.4.1008.15138",
        "templateHash": "15576385974467650524"
      }
    },
    "parameters": {
      "managedIdentityName": {
        "type": "string",
        "metadata": {
          "description": "The name of the managed identity resource."
        },
        "value": "MyManagedIdentity"
      },
      "roleDefinitionIds": {
        "type": "array",
        "metadata": {
          "description": "The IDs of the role definitions to assign to the managed identity. Each role assignment is created at the resource group scope. Role definition IDs are GUIDs. To find the GUID for built-in Azure role definitions, see https://docs.microsoft.com/azure/role-based-access-control/built-in-roles. You can also use IDs of custom role definitions."
        },
        "value": [
          "acdd72a7-3385-48ef-bd42-f606fba81ae7"
        ]
      },
      "roleAssignmentDescription": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "description": "An optional description to apply to each role assignment, such as the reason this managed identity needs to be granted the role."
        }
      },
      "location": {
        "type": "string",
        "defaultValue": "[resourceGroup().location]",
        "metadata": {
          "description": "The Azure location where the managed identity should be created."
        }
      }
    },
    "functions": [],
    "variables": {
      "copy": [
        {
          "name": "roleAssignmentsToCreate",
          "count": 31,
          "input": {
            "name": "[guid(resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName')), resourceGroup().id, parameters('roleDefinitionIds')[copyIndex('roleAssignmentsToCreate')])]",
            "roleDefinitionId": "roleDefinitionIds)[copyIndex(roleAssignmentsToCreate"
          }
        }
      ]
    },
    "resources": [
      {
        "type": "Microsoft.ManagedIdentity/userAssignedIdentities",
        "apiVersion": "2018-11-30",
        "name": "MyManagedIdentity",
        "location": "[resourceGroup().location]"
      },
      {
        "type": "Microsoft.Authorization/roleAssignments",
        "apiVersion": "2020-04-01-preview",
        "name": "(roleAssignmentsToCreate)[copyIndex()].name",
        "properties": {
          "description": "",
          "principalId": "[reference(resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))).principalId]",
          "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleAssignmentsToCreate')[copyIndex()].roleDefinitionId)]",
          "principalType": "ServicePrincipal"
        },
        "dependsOn": [
          "Microsoft.ManagedIdentity/userAssignedIdentities/MyManagedIdentity"
        ]
      },
      {
        "type": "Microsoft.Authorization/roleAssignments",
        "apiVersion": "2020-04-01-preview",
        "name": "(roleAssignmentsToCreate)[copyIndex()].name",
        "properties": {
          "description": "",
          "principalId": "[reference(resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))).principalId]",
          "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleAssignmentsToCreate')[copyIndex()].roleDefinitionId)]",
          "principalType": "ServicePrincipal"
        },
        "dependsOn": [
          "Microsoft.ManagedIdentity/userAssignedIdentities/MyManagedIdentity"
        ]
      },
      {
        "type": "Microsoft.Authorization/roleAssignments",
        "apiVersion": "2020-04-01-preview",
        "name": "(roleAssignmentsToCreate)[copyIndex()].name",
        "properties": {
          "description": "",
          "principalId": "[reference(resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))).principalId]",
          "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleAssignmentsToCreate')[copyIndex()].roleDefinitionId)]",
          "principalType": "ServicePrincipal"
        },
        "dependsOn": [
          "Microsoft.ManagedIdentity/userAssignedIdentities/MyManagedIdentity"
        ]
      },
      {
        "type": "Microsoft.Authorization/roleAssignments",
        "apiVersion": "2020-04-01-preview",
        "name": "(roleAssignmentsToCreate)[copyIndex()].name",
        "properties": {
          "description": "",
          "principalId": "[reference(resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))).principalId]",
          "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleAssignmentsToCreate')[copyIndex()].roleDefinitionId)]",
          "principalType": "ServicePrincipal"
        },
        "dependsOn": [
          "Microsoft.ManagedIdentity/userAssignedIdentities/MyManagedIdentity"
        ]
      },
      {
        "type": "Microsoft.Authorization/roleAssignments",
        "apiVersion": "2020-04-01-preview",
        "name": "(roleAssignmentsToCreate)[copyIndex()].name",
        "properties": {
          "description": "",
          "principalId": "[reference(resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))).principalId]",
          "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleAssignmentsToCreate')[copyIndex()].roleDefinitionId)]",
          "principalType": "ServicePrincipal"
        },
        "dependsOn": [
          "Microsoft.ManagedIdentity/userAssignedIdentities/MyManagedIdentity"
        ]
      },
      {
        "type": "Microsoft.Authorization/roleAssignments",
        "apiVersion": "2020-04-01-preview",
        "name": "(roleAssignmentsToCreate)[copyIndex()].name",
        "properties": {
          "description": "",
          "principalId": "[reference(resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))).principalId]",
          "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleAssignmentsToCreate')[copyIndex()].roleDefinitionId)]",
          "principalType": "ServicePrincipal"
        },
        "dependsOn": [
          "Microsoft.ManagedIdentity/userAssignedIdentities/MyManagedIdentity"
        ]
      },
      {
        "type": "Microsoft.Authorization/roleAssignments",
        "apiVersion": "2020-04-01-preview",
        "name": "(roleAssignmentsToCreate)[copyIndex()].name",
        "properties": {
          "description": "",
          "principalId": "[reference(resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))).principalId]",
          "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleAssignmentsToCreate')[copyIndex()].roleDefinitionId)]",
          "principalType": "ServicePrincipal"
        },
        "dependsOn": [
          "Microsoft.ManagedIdentity/userAssignedIdentities/MyManagedIdentity"
        ]
      },
      {
        "type": "Microsoft.Authorization/roleAssignments",
        "apiVersion": "2020-04-01-preview",
        "name": "(roleAssignmentsToCreate)[copyIndex()].name",
        "properties": {
          "description": "",
          "principalId": "[reference(resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))).principalId]",
          "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleAssignmentsToCreate')[copyIndex()].roleDefinitionId)]",
          "principalType": "ServicePrincipal"
        },
        "dependsOn": [
          "Microsoft.ManagedIdentity/userAssignedIdentities/MyManagedIdentity"
        ]
      },
      {
        "type": "Microsoft.Authorization/roleAssignments",
        "apiVersion": "2020-04-01-preview",
        "name": "(roleAssignmentsToCreate)[copyIndex()].name",
        "properties": {
          "description": "",
          "principalId": "[reference(resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))).principalId]",
          "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleAssignmentsToCreate')[copyIndex()].roleDefinitionId)]",
          "principalType": "ServicePrincipal"
        },
        "dependsOn": [
          "Microsoft.ManagedIdentity/userAssignedIdentities/MyManagedIdentity"
        ]
      },
      {
        "type": "Microsoft.Authorization/roleAssignments",
        "apiVersion": "2020-04-01-preview",
        "name": "(roleAssignmentsToCreate)[copyIndex()].name",
        "properties": {
          "description": "",
          "principalId": "[reference(resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))).principalId]",
          "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleAssignmentsToCreate')[copyIndex()].roleDefinitionId)]",
          "principalType": "ServicePrincipal"
        },
        "dependsOn": [
          "Microsoft.ManagedIdentity/userAssignedIdentities/MyManagedIdentity"
        ]
      },
      {
        "type": "Microsoft.Authorization/roleAssignments",
        "apiVersion": "2020-04-01-preview",
        "name": "(roleAssignmentsToCreate)[copyIndex()].name",
        "properties": {
          "description": "",
          "principalId": "[reference(resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))).principalId]",
          "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleAssignmentsToCreate')[copyIndex()].roleDefinitionId)]",
          "principalType": "ServicePrincipal"
        },
        "dependsOn": [
          "Microsoft.ManagedIdentity/userAssignedIdentities/MyManagedIdentity"
        ]
      },
      {
        "type": "Microsoft.Authorization/roleAssignments",
        "apiVersion": "2020-04-01-preview",
        "name": "(roleAssignmentsToCreate)[copyIndex()].name",
        "properties": {
          "description": "",
          "principalId": "[reference(resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))).principalId]",
          "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleAssignmentsToCreate')[copyIndex()].roleDefinitionId)]",
          "principalType": "ServicePrincipal"
        },
        "dependsOn": [
          "Microsoft.ManagedIdentity/userAssignedIdentities/MyManagedIdentity"
        ]
      },
      {
        "type": "Microsoft.Authorization/roleAssignments",
        "apiVersion": "2020-04-01-preview",
        "name": "(roleAssignmentsToCreate)[copyIndex()].name",
        "properties": {
          "description": "",
          "principalId": "[reference(resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))).principalId]",
          "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleAssignmentsToCreate')[copyIndex()].roleDefinitionId)]",
          "principalType": "ServicePrincipal"
        },
        "dependsOn": [
          "Microsoft.ManagedIdentity/userAssignedIdentities/MyManagedIdentity"
        ]
      },
      {
        "type": "Microsoft.Authorization/roleAssignments",
        "apiVersion": "2020-04-01-preview",
        "name": "(roleAssignmentsToCreate)[copyIndex()].name",
        "properties": {
          "description": "",
          "principalId": "[reference(resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))).principalId]",
          "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleAssignmentsToCreate')[copyIndex()].roleDefinitionId)]",
          "principalType": "ServicePrincipal"
        },
        "dependsOn": [
          "Microsoft.ManagedIdentity/userAssignedIdentities/MyManagedIdentity"
        ]
      },
      {
        "type": "Microsoft.Authorization/roleAssignments",
        "apiVersion": "2020-04-01-preview",
        "name": "(roleAssignmentsToCreate)[copyIndex()].name",
        "properties": {
          "description": "",
          "principalId": "[reference(resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))).principalId]",
          "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleAssignmentsToCreate')[copyIndex()].roleDefinitionId)]",
          "principalType": "ServicePrincipal"
        },
        "dependsOn": [
          "Microsoft.ManagedIdentity/userAssignedIdentities/MyManagedIdentity"
        ]
      },
      {
        "type": "Microsoft.Authorization/roleAssignments",
        "apiVersion": "2020-04-01-preview",
        "name": "(roleAssignmentsToCreate)[copyIndex()].name",
        "properties": {
          "description": "",
          "principalId": "[reference(resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))).principalId]",
          "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleAssignmentsToCreate')[copyIndex()].roleDefinitionId)]",
          "principalType": "ServicePrincipal"
        },
        "dependsOn": [
          "Microsoft.ManagedIdentity/userAssignedIdentities/MyManagedIdentity"
        ]
      },
      {
        "type": "Microsoft.Authorization/roleAssignments",
        "apiVersion": "2020-04-01-preview",
        "name": "(roleAssignmentsToCreate)[copyIndex()].name",
        "properties": {
          "description": "",
          "principalId": "[reference(resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))).principalId]",
          "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleAssignmentsToCreate')[copyIndex()].roleDefinitionId)]",
          "principalType": "ServicePrincipal"
        },
        "dependsOn": [
          "Microsoft.ManagedIdentity/userAssignedIdentities/MyManagedIdentity"
        ]
      },
      {
        "type": "Microsoft.Authorization/roleAssignments",
        "apiVersion": "2020-04-01-preview",
        "name": "(roleAssignmentsToCreate)[copyIndex()].name",
        "properties": {
          "description": "",
          "principalId": "[reference(resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))).principalId]",
          "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleAssignmentsToCreate')[copyIndex()].roleDefinitionId)]",
          "principalType": "ServicePrincipal"
        },
        "dependsOn": [
          "Microsoft.ManagedIdentity/userAssignedIdentities/MyManagedIdentity"
        ]
      },
      {
        "type": "Microsoft.Authorization/roleAssignments",
        "apiVersion": "2020-04-01-preview",
        "name": "(roleAssignmentsToCreate)[copyIndex()].name",
        "properties": {
          "description": "",
          "principalId": "[reference(resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))).principalId]",
          "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleAssignmentsToCreate')[copyIndex()].roleDefinitionId)]",
          "principalType": "ServicePrincipal"
        },
        "dependsOn": [
          "Microsoft.ManagedIdentity/userAssignedIdentities/MyManagedIdentity"
        ]
      },
      {
        "type": "Microsoft.Authorization/roleAssignments",
        "apiVersion": "2020-04-01-preview",
        "name": "(roleAssignmentsToCreate)[copyIndex()].name",
        "properties": {
          "description": "",
          "principalId": "[reference(resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))).principalId]",
          "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleAssignmentsToCreate')[copyIndex()].roleDefinitionId)]",
          "principalType": "ServicePrincipal"
        },
        "dependsOn": [
          "Microsoft.ManagedIdentity/userAssignedIdentities/MyManagedIdentity"
        ]
      },
      {
        "type": "Microsoft.Authorization/roleAssignments",
        "apiVersion": "2020-04-01-preview",
        "name": "(roleAssignmentsToCreate)[copyIndex()].name",
        "properties": {
          "description": "",
          "principalId": "[reference(resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))).principalId]",
          "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleAssignmentsToCreate')[copyIndex()].roleDefinitionId)]",
          "principalType": "ServicePrincipal"
        },
        "dependsOn": [
          "Microsoft.ManagedIdentity/userAssignedIdentities/MyManagedIdentity"
        ]
      },
      {
        "type": "Microsoft.Authorization/roleAssignments",
        "apiVersion": "2020-04-01-preview",
        "name": "(roleAssignmentsToCreate)[copyIndex()].name",
        "properties": {
          "description": "",
          "principalId": "[reference(resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))).principalId]",
          "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleAssignmentsToCreate')[copyIndex()].roleDefinitionId)]",
          "principalType": "ServicePrincipal"
        },
        "dependsOn": [
          "Microsoft.ManagedIdentity/userAssignedIdentities/MyManagedIdentity"
        ]
      },
      {
        "type": "Microsoft.Authorization/roleAssignments",
        "apiVersion": "2020-04-01-preview",
        "name": "(roleAssignmentsToCreate)[copyIndex()].name",
        "properties": {
          "description": "",
          "principalId": "[reference(resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))).principalId]",
          "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleAssignmentsToCreate')[copyIndex()].roleDefinitionId)]",
          "principalType": "ServicePrincipal"
        },
        "dependsOn": [
          "Microsoft.ManagedIdentity/userAssignedIdentities/MyManagedIdentity"
        ]
      }
    ],
    "outputs": {
      "managedIdentityResourceId": {
        "type": "string",
        "value": "[resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))]",
        "metadata": {
          "description": "The resource ID of the user-assigned managed identity."
        }
      },
      "managedIdentityClientId": {
        "type": "string",
        "value": "[reference(resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))).clientId]",
        "metadata": {
          "description": "The ID of the Azure AD application associated with the managed identity."
        }
      },
      "managedIdentityPrincipalId": {
        "type": "string",
        "value": "[reference(resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', parameters('managedIdentityName'))).principalId]",
        "metadata": {
          "description": "The ID of the Azure AD service principal associated with the managed identity."
        }
      }
    },
    "\uff04schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#"
  }
}