{
  "structure": "filesystem",
  "error": null,
  "reference": "master",
  "contentType": "json",
  "source": "gitConnectorAzureQuickStart",
  "paths": [
    "/application-workloads/cloudera/cloudera-tableau/nested/ds13.json"
  ],
  "timestamp": 1642962885954,
  "queryuser": null,
  "checksum": "99914b932bd37a50b983c5e7c90ae93b",
  "node": {
    "masterSnapshotId": "ARM_TEMPLATE_SNAPSHOT",
    "type": "arm",
    "collection": "armtemplate",
    "paths": [
      "/application-workloads/cloudera/cloudera-tableau/nested/ds13.json"
    ],
    "snapshotId": "ARM_TEMPLATE_SNAPSHOT91",
    "status": "active",
    "validate": true,
    "resourceTypes": [
      "microsoft.resources/deployments"
    ]
  },
  "snapshotId": "ARM_TEMPLATE_SNAPSHOT91",
  "collection": "armtemplate",
  "json": {
    "contentVersion": "1.0.0.1",
    "parameters": {
      "adminUsername": {
        "type": "string",
        "defaultValue": "azureuser",
        "metadata": {
          "description": "Admin user name for the VMs"
        }
      },
      "adminPassword": {
        "type": "securestring",
        "metadata": {
          "description": "Admin password for the VMs (A mix of upper and lower-case characters, digits and symbols)"
        }
      },
      "cmUsername": {
        "type": "string",
        "defaultValue": "cmadmin",
        "metadata": {
          "description": "User name for the Cloudera Manager"
        }
      },
      "cmPassword": {
        "type": "securestring",
        "metadata": {
          "description": "password for the Cloudera Manager (A mix of upper and lower-case characters, digits and symbols)"
        }
      },
      "storageAccountPrefix": {
        "type": "string",
        "metadata": {
          "description": "Unique namespace for the Storage Account where the VM disks will be placed (alphahumeric characters only)"
        }
      },
      "dnsNamePrefix": {
        "type": "string",
        "metadata": {
          "description": "Unique public DNS name where the VMs will be exposed"
        }
      },
      "masterStorageAccountType": {
        "type": "string",
        "defaultValue": "Premium_LRS",
        "metadata": {
          "description": "The type of the Storage Account to be created for master nodes (defaults to Premium_LRS)"
        }
      },
      "workerStorageAccountType": {
        "type": "string",
        "defaultValue": "Standard_LRS",
        "metadata": {
          "description": "The type of the Storage Account to be created for worker nodes (defaults to Standard_LRS)"
        }
      },
      "virtualNetworkName": {
        "type": "string",
        "defaultValue": "clouderavnet",
        "metadata": {
          "description": "The name of the virtual network provisioned for the deployment"
        }
      },
      "vnetNewOrExisting": {
        "type": "string",
        "defaultValue": "new",
        "allowedValues": [
          "new",
          "existing"
        ],
        "metadata": {
          "description": "Indicator for new or exiting Virtual Network"
        }
      },
      "virtualNetworkRGName": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "description": "Resource Group Name for Vnet. For new VNet leave it empty, otherwise type in existing resource group name"
        }
      },
      "subnetName": {
        "type": "string",
        "defaultValue": "clouderasubnet",
        "metadata": {
          "description": "Subnet name for the virtual network where resources will be provisioned"
        }
      },
      "addressPrefix": {
        "type": "string",
        "defaultValue": "10.3.0.0/16",
        "metadata": {
          "description": "Virtual Network address CIDR"
        }
      },
      "subnetPrefix": {
        "type": "string",
        "defaultValue": "10.3.0.0/16",
        "metadata": {
          "description": "CIDR for the subnet where VMs will be placed"
        }
      },
      "masterNodeIPAddress": {
        "type": "string",
        "defaultValue": "10.3.0.4",
        "metadata": {
          "description": "IP address for the first master"
        }
      },
      "dataNodeIPOffSetFromMaster": {
        "type": "int",
        "defaultValue": 10,
        "metadata": {
          "description": "IP address from the master node, for example if the first master is 10.1.1.1, then the first dataNode would be 10.1.1.11"
        }
      },
      "tshirtSize": {
        "type": "string",
        "defaultValue": "Eval",
        "allowedValues": [
          "Eval",
          "Prod"
        ],
        "metadata": {
          "description": "T-shirt size of the Cloudera cluster (Eval, Prod)"
        }
      },
      "numberOfDataNodes": {
        "type": "int",
        "defaultValue": 3,
        "metadata": {
          "description": "Number of data nodes for Prod (defaults to 3)"
        }
      },
      "vmSize": {
        "type": "string",
        "defaultValue": "Standard_D8s_v3",
        "metadata": {
          "description": "The size of the VMs deployed in the cluster (defaults to Standard_DS13)"
        }
      },
      "company": {
        "type": "string",
        "defaultValue": "Company",
        "metadata": {
          "description": "Your Company"
        }
      },
      "emailAddress": {
        "type": "string",
        "defaultValue": "email@yourcompany.com",
        "metadata": {
          "description": "your email"
        }
      },
      "businessPhone": {
        "type": "string",
        "defaultValue": "123456789",
        "metadata": {
          "description": "your business phone number"
        }
      },
      "firstName": {
        "type": "string",
        "defaultValue": "FirstName",
        "metadata": {
          "description": "Your FirstName"
        }
      },
      "lastName": {
        "type": "string",
        "defaultValue": "LastName",
        "metadata": {
          "description": "Your LastName"
        }
      },
      "jobRole": {
        "type": "string",
        "defaultValue": "Administrator",
        "metadata": {
          "description": "Job Role"
        },
        "allowedValues": [
          "Administrator",
          "Analyst (Industry/Finance)",
          "Analyst (Technical)",
          "Architect",
          "C level",
          "Consultant",
          "Developer",
          "Director",
          "Engineer",
          "Individual contributor",
          "Manager",
          "Partner",
          "Student",
          "VP"
        ]
      },
      "jobFunction": {
        "type": "string",
        "defaultValue": "Analytics / Business Intelligence",
        "metadata": {
          "description": "Job Function"
        },
        "allowedValues": [
          "Analytics / Business Intelligence",
          "Big Data / Architecture",
          "Data Warehouse / Management",
          "Data Science",
          "Database",
          "ETL / ELT",
          "Infrastructure",
          "IT",
          "Marketing / Sales",
          "Networking",
          "Manager",
          "Security / Compliance",
          "Storage"
        ]
      },
      "clouderaTags": {
        "type": "object"
      },
      "tableauTags": {
        "type": "object"
      },
      "quickstartTags": {
        "type": "object"
      }
    },
    "variables": {
      "templateAPIVersion": "2015-11-01",
      "resourceAPIVersion": "2015-06-15",
      "installCDH": "True",
      "addressPrefix": "10.3.0.0/16",
      "subnetPrefix": "10.3.0.0/16",
      "scriptsUri": "https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/cloudera-on-centos",
      "share-resourcesUri": "https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/cloudera-on-centos/nested/shared-resources-new-vnet.json",
      "data-nodeUri": "[concat(variables('scriptsUri'), '/nested/data-node-', toLower(subString(parameters('vmSize'), 9, 4)), '.json')]",
      "sa": "10.3.0.4",
      "ipOctet01": "[concat(split(variables('sa'), '.')[0], '.', split(variables('sa'), '.')[1], '.')]",
      "ipOctet2": "[int(split(variables('sa'), '.')[2])]",
      "ipOctet3": "[int(split(variables('sa'), '.')[3])]",
      "datanodeIpOctet3": "[add(int(split(variables('sa'), '.')[3]), parameters('dataNodeIPOffSetFromMaster'))]",
      "masterStorageAccount": {
        "prefix": "storageAccountPrefix",
        "type": "Premium_LRS"
      },
      "workerStorageAccount": {
        "prefix": "storageAccountPrefix",
        "type": "Standard_LRS"
      },
      "clusterTshirtSizeEval": {
        "masterNodeCount": 1,
        "dataNodeCount": 3,
        "highAvailability": "false"
      },
      "clusterTshirtSizeProd": {
        "masterNodeCount": 3,
        "dataNodeCount": 3,
        "highAvailability": "true"
      },
      "clusterSpec": "concat(clusterTshirtSize, parameters(tshirtSize))",
      "vmSpec": {
        "vmSize": "Standard_D8s_v3",
        "adminUsername": "azureuser",
        "adminPassword": "adminPassword",
        "masterNodeASName": "dnsNamePrefix-mnAS",
        "dataNodeASName": "dnsNamePrefix-dnAS"
      },
      "networkSpec": {
        "addressPrefix": "10.3.0.0/16",
        "subnetPrefix": "10.3.0.0/16",
        "ipOctet01": "[concat(split(variables('sa'), '.')[0], '.', split(variables('sa'), '.')[1], '.')]",
        "ipOctet2": "[int(split(variables('sa'), '.')[2])]",
        "ipOctet3": "[int(split(variables('sa'), '.')[3])]",
        "datanodeIpOctet3": "[add(int(split(variables('sa'), '.')[3]), parameters('dataNodeIPOffSetFromMaster'))]",
        "masterIP": "10.3.0.4",
        "workerIP": "[concat(variables('ipOctet01'), add(variables('ipOctet2'), div(variables('datanodeIpOctet3'), 255)), '.', mod(variables('datanodeIpOctet3'), 255))]",
        "virtualNetworkName": "clouderavnet",
        "virtualNetworkRGName": "",
        "vnetNewOrExisting": "new",
        "virtualNetworkSubnetName": "clouderasubnet"
      },
      "newVNetId": "Microsoft.Network/virtualNetworks/clouderavnet",
      "existingVNetId": "parameters('virtualNetworkRGName')/Microsoft.Network/virtualNetworks/clouderavnet",
      "VNetId": "concat(parameters(vnetNewOrExisting),VNetId)"
    },
    "resources": [
      {
        "name": "shared-resources",
        "type": "Microsoft.Resources/deployments",
        "apiVersion": "2015-11-01",
        "comments": "Utilizes the shared resources configurations.  Uses the DS13 servers sizes for the deployment",
        "properties": {
          "mode": "Incremental",
          "templateLink": {
            "uri": "https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/cloudera-on-centos/nested/shared-resources-new-vnet.json",
            "contentVersion": "1.0.0.1"
          },
          "parameters": {
            "resourceAPIVersion": {
              "value": "2015-06-15"
            },
            "networkSpec": {
              "value": {
                "addressPrefix": "10.3.0.0/16",
                "subnetPrefix": "10.3.0.0/16",
                "ipOctet01": "[concat(split(variables('sa'), '.')[0], '.', split(variables('sa'), '.')[1], '.')]",
                "ipOctet2": "[int(split(variables('sa'), '.')[2])]",
                "ipOctet3": "[int(split(variables('sa'), '.')[3])]",
                "datanodeIpOctet3": "[add(int(split(variables('sa'), '.')[3]), parameters('dataNodeIPOffSetFromMaster'))]",
                "masterIP": "10.3.0.4",
                "workerIP": "[concat(variables('ipOctet01'), add(variables('ipOctet2'), div(variables('datanodeIpOctet3'), 255)), '.', mod(variables('datanodeIpOctet3'), 255))]",
                "virtualNetworkName": "clouderavnet",
                "virtualNetworkRGName": "",
                "vnetNewOrExisting": "new",
                "virtualNetworkSubnetName": "clouderasubnet"
              }
            },
            "masterNodeASName": {
              "value": "(vmSpec).masterNodeASName"
            },
            "dataNodeASName": {
              "value": "(vmSpec).dataNodeASName"
            },
            "clouderaTags": {
              "value": "clouderaTags"
            },
            "tableauTags": {
              "value": "tableauTags"
            },
            "quickstartTags": {
              "value": "quickstartTags"
            }
          }
        }
      },
      {
        "name": "master-node",
        "type": "Microsoft.Resources/deployments",
        "apiVersion": "2015-11-01",
        "comments": "Cloudera Master Node resource",
        "dependsOn": [
          "Microsoft.Resources/deployments/shared-resources"
        ],
        "properties": {
          "mode": "Incremental",
          "templateLink": {
            "uri": "https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/cloudera-on-centos/nested/master-node.json",
            "contentVersion": "1.0.0.1"
          },
          "parameters": {
            "vnetID": {
              "value": "concat(parameters(vnetNewOrExisting),VNetId)"
            },
            "resourceAPIVersion": {
              "value": "2015-06-15"
            },
            "dnsNamePrefix": {
              "value": "dnsNamePrefix"
            },
            "scriptsUri": {
              "value": "https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/cloudera-on-centos"
            },
            "storageAccount": {
              "value": {
                "prefix": "storageAccountPrefix",
                "type": "Premium_LRS"
              }
            },
            "vmCount": {
              "value": "(clusterSpec).masterNodeCount"
            },
            "vmSpec": {
              "value": {
                "vmSize": "Standard_D8s_v3",
                "adminUsername": "azureuser",
                "adminPassword": "adminPassword",
                "masterNodeASName": "dnsNamePrefix-mnAS",
                "dataNodeASName": "dnsNamePrefix-dnAS"
              }
            },
            "networkSpec": {
              "value": {
                "addressPrefix": "10.3.0.0/16",
                "subnetPrefix": "10.3.0.0/16",
                "ipOctet01": "[concat(split(variables('sa'), '.')[0], '.', split(variables('sa'), '.')[1], '.')]",
                "ipOctet2": "[int(split(variables('sa'), '.')[2])]",
                "ipOctet3": "[int(split(variables('sa'), '.')[3])]",
                "datanodeIpOctet3": "[add(int(split(variables('sa'), '.')[3]), parameters('dataNodeIPOffSetFromMaster'))]",
                "masterIP": "10.3.0.4",
                "workerIP": "[concat(variables('ipOctet01'), add(variables('ipOctet2'), div(variables('datanodeIpOctet3'), 255)), '.', mod(variables('datanodeIpOctet3'), 255))]",
                "virtualNetworkName": "clouderavnet",
                "virtualNetworkRGName": "",
                "vnetNewOrExisting": "new",
                "virtualNetworkSubnetName": "clouderasubnet"
              }
            },
            "clusterSpec": {
              "value": "concat(clusterTshirtSize, parameters(tshirtSize))"
            },
            "clouderaTags": {
              "value": "clouderaTags"
            },
            "tableauTags": {
              "value": "tableauTags"
            },
            "quickstartTags": {
              "value": "quickstartTags"
            }
          }
        }
      },
      {
        "name": "data-node",
        "type": "Microsoft.Resources/deployments",
        "apiVersion": "2015-11-01",
        "comments": "Cloudera Data Node resource",
        "dependsOn": [
          "Microsoft.Resources/deployments/shared-resources"
        ],
        "properties": {
          "mode": "Incremental",
          "templateLink": {
            "uri": "[variables('data-nodeUri')]",
            "contentVersion": "1.0.0.1"
          },
          "parameters": {
            "vnetID": {
              "value": "concat(parameters(vnetNewOrExisting),VNetId)"
            },
            "resourceAPIVersion": {
              "value": "2015-06-15"
            },
            "dnsNamePrefix": {
              "value": "dnsNamePrefix"
            },
            "scriptsUri": {
              "value": "https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/cloudera-on-centos"
            },
            "storageAccount": {
              "value": {
                "prefix": "storageAccountPrefix",
                "type": "Standard_LRS"
              }
            },
            "vmCount": {
              "value": "(clusterSpec).dataNodeCount"
            },
            "vmSpec": {
              "value": {
                "vmSize": "Standard_D8s_v3",
                "adminUsername": "azureuser",
                "adminPassword": "adminPassword",
                "masterNodeASName": "dnsNamePrefix-mnAS",
                "dataNodeASName": "dnsNamePrefix-dnAS"
              }
            },
            "networkSpec": {
              "value": {
                "addressPrefix": "10.3.0.0/16",
                "subnetPrefix": "10.3.0.0/16",
                "ipOctet01": "[concat(split(variables('sa'), '.')[0], '.', split(variables('sa'), '.')[1], '.')]",
                "ipOctet2": "[int(split(variables('sa'), '.')[2])]",
                "ipOctet3": "[int(split(variables('sa'), '.')[3])]",
                "datanodeIpOctet3": "[add(int(split(variables('sa'), '.')[3]), parameters('dataNodeIPOffSetFromMaster'))]",
                "masterIP": "10.3.0.4",
                "workerIP": "[concat(variables('ipOctet01'), add(variables('ipOctet2'), div(variables('datanodeIpOctet3'), 255)), '.', mod(variables('datanodeIpOctet3'), 255))]",
                "virtualNetworkName": "clouderavnet",
                "virtualNetworkRGName": "",
                "vnetNewOrExisting": "new",
                "virtualNetworkSubnetName": "clouderasubnet"
              }
            },
            "clusterSpec": {
              "value": "concat(clusterTshirtSize, parameters(tshirtSize))"
            },
            "clouderaTags": {
              "value": "clouderaTags"
            },
            "tableauTags": {
              "value": "tableauTags"
            },
            "quickstartTags": {
              "value": "quickstartTags"
            }
          }
        }
      },
      {
        "name": "setup-cloudera",
        "type": "Microsoft.Resources/deployments",
        "apiVersion": "2015-11-01",
        "comments": "Resources that setup the Cloudera cluster",
        "dependsOn": [
          "Microsoft.Resources/deployments/data-node",
          "Microsoft.Resources/deployments/master-node"
        ],
        "properties": {
          "mode": "Incremental",
          "templateLink": {
            "uri": "https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/cloudera-on-centos/nested/setup-cloudera.json",
            "contentVersion": "1.0.0.1"
          },
          "parameters": {
            "resourceAPIVersion": {
              "value": "2015-06-15"
            },
            "dnsNamePrefix": {
              "value": "dnsNamePrefix"
            },
            "scriptsUri": {
              "value": "https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/cloudera-on-centos"
            },
            "vmSpec": {
              "value": {
                "vmSize": "Standard_D8s_v3",
                "adminUsername": "azureuser",
                "adminPassword": "adminPassword",
                "masterNodeASName": "dnsNamePrefix-mnAS",
                "dataNodeASName": "dnsNamePrefix-dnAS"
              }
            },
            "networkSpec": {
              "value": {
                "addressPrefix": "10.3.0.0/16",
                "subnetPrefix": "10.3.0.0/16",
                "ipOctet01": "[concat(split(variables('sa'), '.')[0], '.', split(variables('sa'), '.')[1], '.')]",
                "ipOctet2": "[int(split(variables('sa'), '.')[2])]",
                "ipOctet3": "[int(split(variables('sa'), '.')[3])]",
                "datanodeIpOctet3": "[add(int(split(variables('sa'), '.')[3]), parameters('dataNodeIPOffSetFromMaster'))]",
                "masterIP": "10.3.0.4",
                "workerIP": "[concat(variables('ipOctet01'), add(variables('ipOctet2'), div(variables('datanodeIpOctet3'), 255)), '.', mod(variables('datanodeIpOctet3'), 255))]",
                "virtualNetworkName": "clouderavnet",
                "virtualNetworkRGName": "",
                "vnetNewOrExisting": "new",
                "virtualNetworkSubnetName": "clouderasubnet"
              }
            },
            "clusterSpec": {
              "value": "concat(clusterTshirtSize, parameters(tshirtSize))"
            },
            "fqdn": {
              "value": "[reference('master-node').outputs.fqdn.value]"
            },
            "cmUsername": {
              "value": "cmadmin"
            },
            "cmPassword": {
              "value": "cmPassword"
            },
            "company": {
              "value": "Company"
            },
            "emailAddress": {
              "value": "email@yourcompany.com"
            },
            "businessPhone": {
              "value": "123456789"
            },
            "firstName": {
              "value": "FirstName"
            },
            "lastName": {
              "value": "LastName"
            },
            "jobRole": {
              "value": "Administrator"
            },
            "jobFunction": {
              "value": "Analytics / Business Intelligence"
            },
            "installCDH": {
              "value": "True"
            },
            "clouderaTags": {
              "value": "clouderaTags"
            },
            "tableauTags": {
              "value": "tableauTags"
            },
            "quickstartTags": {
              "value": "quickstartTags"
            }
          }
        }
      }
    ],
    "\uff04schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#"
  }
}