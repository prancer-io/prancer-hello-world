{
  "structure": "filesystem",
  "error": null,
  "reference": "master",
  "contentType": "json",
  "source": "gitConnectorAzureQuickStart",
  "paths": [
    "/demos/oms-azure-storage-analytics-solution/nestedtemplates/omsDeployStorageAnalyticsWithAuditLogs.json"
  ],
  "timestamp": 1642962900789,
  "queryuser": null,
  "checksum": "99914b932bd37a50b983c5e7c90ae93b",
  "node": {
    "masterSnapshotId": "ARM_TEMPLATE_SNAPSHOT",
    "type": "arm",
    "collection": "armtemplate",
    "paths": [
      "/demos/oms-azure-storage-analytics-solution/nestedtemplates/omsDeployStorageAnalyticsWithAuditLogs.json"
    ],
    "snapshotId": "ARM_TEMPLATE_SNAPSHOT757",
    "status": "active",
    "validate": true,
    "resourceTypes": [
      "microsoft.resources/deployments"
    ]
  },
  "snapshotId": "ARM_TEMPLATE_SNAPSHOT757",
  "collection": "armtemplate",
  "json": {
    "contentVersion": "1.0.0.0",
    "parameters": {
      "deploymentNameSuffix": {
        "type": "string",
        "metadata": {
          "description": "Used to create unique deployment names for subsequent deployments"
        }
      },
      "omsLogAnalyticsWorkspaceName": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "description": "Create new or use an existing Log Analytic Workspace"
        }
      },
      "omsLogAnalyticsRegion": {
        "type": "string",
        "allowedValues": [
          "westeurope",
          "eastus",
          "southeastasia",
          "australiasoutheast",
          "westcentralus",
          "japaneast",
          "uksouth",
          "centralindia",
          "canadacentral"
        ],
        "metadata": {
          "description": "Specify the Azure Region for your new or existing OMS workspace"
        }
      },
      "omsLogAnalyticsSku": {
        "type": "string",
        "defaultValue": "free",
        "allowedValues": [
          "free",
          "standalone",
          "pernode"
        ],
        "metadata": {
          "description": "Specify the Azure Region for your OMS Automation Account"
        }
      },
      "omsAutomationAccountName": {
        "type": "string",
        "defaultValue": "",
        "metadata": {
          "description": "Use an existing Automation account or create a new"
        }
      },
      "omsAutomationRegion": {
        "type": "string",
        "allowedValues": [
          "westeurope",
          "southeastasia",
          "eastus2",
          "southcentralus",
          "japaneast",
          "southeastasia",
          "southcentralus",
          "northeurope",
          "canadacentral",
          "australiasoutheast",
          "centralindia",
          "japaneast",
          "northcentralus",
          "brazilsouth",
          "uksouth",
          "westcentralus"
        ],
        "metadata": {
          "description": "Specify the Azure Region for your OMS Automation Account"
        }
      },
      "omsWorkspaceType": {
        "type": "string",
        "allowedValues": [
          "Linked",
          "Unlinked"
        ],
        "metadata": {
          "description": "Specify the workspace type"
        }
      },
      "linkedWorkspaceSKU": {
        "type": "array",
        "defaultValue": [
          "pernode",
          "OMS"
        ],
        "allowedValues": [
          [
            "pernode",
            "OMS"
          ],
          [
            "free",
            "free"
          ]
        ],
        "metadata": {
          "description": "Choose the SKU for linked workspace  , only valid  if omsWorkspaceType is Linked otherwise ignored."
        }
      },
      "collectAuditLogs": {
        "type": "string",
        "allowedValues": [
          "Enabled",
          "Disabled"
        ],
        "metadata": {
          "description": "This option creates extra collectors to collect and ingest storage audit logs"
        }
      },
      "collectionFromAllSubscriptions": {
        "type": "string",
        "allowedValues": [
          "Enabled",
          "Disabled"
        ],
        "metadata": {
          "description": "Enables data collection from all subscriptions where Azure SPN has access"
        }
      },
      "_artifactsLocation": {
        "type": "string",
        "defaultValue": "https://raw.githubusercontent.com/Volkanco/AzureDeploy/master/OMSSolutions/oms-azure-storage-analytics-solution-v2",
        "metadata": {
          "description": "The base URI where artifacts required by this template are located"
        }
      },
      "_artifactsLocationSasToken": {
        "type": "securestring",
        "defaultValue": "",
        "metadata": {
          "description": "The sasToken required to access _artifactsLocation.  When the template is deployed using the accompanying scripts, a sasToken will be automatically generated"
        }
      }
    },
    "variables": {
      "nestedTemplates": {
        "deployToLinkedWorkspaceWithAuditLogs": "https://raw.githubusercontent.com/Volkanco/AzureDeploy/master/OMSSolutions/oms-azure-storage-analytics-solution-v2/nestedtemplates/deployToLinkedWorkspaceWithAuditLogs.json parameters('_artifactsLocationSasToken')",
        "deployToWorkspaceWithAuditLogs": "https://raw.githubusercontent.com/Volkanco/AzureDeploy/master/OMSSolutions/oms-azure-storage-analytics-solution-v2/nestedtemplates/deployToWorkspaceWithAuditLogs.json parameters('_artifactsLocationSasToken')"
      }
    },
    "resources": [
      {
        "condition": false,
        "type": "Microsoft.Resources/deployments",
        "apiVersion": "2016-02-01",
        "name": "AS-AnalyticswithLogs-Linked-deploymentNameSuffix",
        "dependsOn": [],
        "properties": {
          "mode": "Incremental",
          "templateLink": {
            "uri": "(nestedTemplates).deployToLinkedWorkspaceWithAuditLogs",
            "contentVersion": "1.0.0.0"
          },
          "parameters": {
            "deploymentNameSuffix": {
              "value": "deploymentNameSuffix"
            },
            "omsLogAnalyticsWorkspaceName": {
              "value": ""
            },
            "omsLogAnalyticsRegion": {
              "value": "omsLogAnalyticsRegion"
            },
            "omsLogAnalyticsSku": {
              "value": "free"
            },
            "omsAutomationAccountName": {
              "value": ""
            },
            "omsAutomationRegion": {
              "value": "omsAutomationRegion"
            },
            "linkedWorkspaceSKU": {
              "value": [
                "pernode",
                "OMS"
              ]
            },
            "collectAuditLogs": {
              "value": "collectAuditLogs"
            },
            "collectionFromAllSubscriptions": {
              "value": "collectionFromAllSubscriptions"
            },
            "_artifactsLocation": {
              "value": "https://raw.githubusercontent.com/Volkanco/AzureDeploy/master/OMSSolutions/oms-azure-storage-analytics-solution-v2"
            }
          }
        }
      },
      {
        "condition": false,
        "type": "Microsoft.Resources/deployments",
        "apiVersion": "2016-02-01",
        "name": "AS-AnalyticswithLogs-deploymentNameSuffix",
        "properties": {
          "mode": "Incremental",
          "templateLink": {
            "uri": "(nestedTemplates).deployToWorkspaceWithAuditLogs",
            "contentVersion": "1.0.0.0"
          },
          "parameters": {
            "deploymentNameSuffix": {
              "value": "deploymentNameSuffix"
            },
            "omsLogAnalyticsWorkspaceName": {
              "value": ""
            },
            "omsLogAnalyticsRegion": {
              "value": "omsLogAnalyticsRegion"
            },
            "omsLogAnalyticsSku": {
              "value": "free"
            },
            "omsAutomationAccountName": {
              "value": ""
            },
            "omsAutomationRegion": {
              "value": "omsAutomationRegion"
            },
            "linkedWorkspaceSKU": {
              "value": [
                "pernode",
                "OMS"
              ]
            },
            "collectAuditLogs": {
              "value": "collectAuditLogs"
            },
            "collectionFromAllSubscriptions": {
              "value": "collectionFromAllSubscriptions"
            },
            "_artifactsLocation": {
              "value": "https://raw.githubusercontent.com/Volkanco/AzureDeploy/master/OMSSolutions/oms-azure-storage-analytics-solution-v2"
            }
          }
        }
      }
    ],
    "outputs": {},
    "\uff04schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#"
  }
}